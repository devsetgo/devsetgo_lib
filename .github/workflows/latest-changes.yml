# TODO: Look for an alternative

name: Latest Changes
on:
  pull_request_target:
    branches:
      - main
      - master
    types:
      - closed
jobs:
  latest-changes:
    if: github.event.pull_request.merged == true
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Dump GitHub context
        env:
          GITHUB_CONTEXT: ${{ toJson(github) }}
        run: echo "$GITHUB_CONTEXT"
      - uses: docker://tiangolo/latest-changes:0.2.1
        with:
          token: ${{ secrets.RELEASE_NOTES }}
          latest_changes_file: docs/release-notes.md
          latest_changes_header: '# Release Notes'
        end_regex: '^## '
        debug_logs: true
        # Here we use a yaml multiline string to pass a JSON array of JSON objects in a more readable way
        # In these case we use the same default labels and the same header titles, but the headers use 3 hash symbols instead of the default of 4
        # We also add a custom last label "egg" for PRs with easter eggs.
        labels: >
          [
            {"label": "breaking", "header": "Breaking Changes"},
            {"label": "security", "header": "Security Fixes"},
            {"label": "feature", "header": "Features"},
            {"label": "bug", "header": "Fixes"},
            {"label": "refactor", "header": "Refactors"},
            {"label": "upgrade", "header": "Upgrades"},
            {"label": "docs", "header": "Docs"},
            {"label": "lang-all", "header": "Translations"},
            {"label": "internal", "header": "Internal"},
            {"label": "egg", "header": "Easter Eggs"}
          ]
        # This will be added to the start of each label's header and
        # will be used to detect existing label headers
        label_header_prefix: '### 
