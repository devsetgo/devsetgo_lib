
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Common functions for Python applications. This is to increase reusability and limit rewritting the same functions in multiple applications. It also allows for defects to be addressed quickly and then be propigated across applications.">
      
      
        <meta name="author" content="Mike Ryan">
      
      
      
        <link rel="prev" href="../async_database_setup/">
      
      
        <link rel="next" href="../../recipes/fastapi/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.18">
    
    
      
        <title>Database Operations - DSG_LIB</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.66ac8b77.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/print-site-enum-headings1.css">
    
      <link rel="stylesheet" href="../../css/print-site-enum-headings2.css">
    
      <link rel="stylesheet" href="../../css/print-site-enum-headings3.css">
    
      <link rel="stylesheet" href="../../css/print-site-enum-headings4.css">
    
      <link rel="stylesheet" href="../../css/print-site-enum-headings5.css">
    
      <link rel="stylesheet" href="../../css/print-site-enum-headings6.css">
    
      <link rel="stylesheet" href="../../css/print-site.css">
    
      <link rel="stylesheet" href="../../css/print-site-material.css">
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="DSG_LIB" class="md-header__button md-logo" aria-label="DSG_LIB" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            DSG_LIB
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Database Operations
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/devsetgo/dsg_lib" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    devsetgo/dsg_lib
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Introduction

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../quickstart/" class="md-tabs__link">
        
  
    
  
  QuickStart

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../common_functions/logging/" class="md-tabs__link">
          
  
  Common Functions

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../fastapi/http_codes/" class="md-tabs__link">
          
  
  FastAPI Functions

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../base_schema/" class="md-tabs__link">
          
  
  Database Functions

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../recipes/fastapi/" class="md-tabs__link">
          
  
  Recipes

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../contribute/" class="md-tabs__link">
          
  
  About

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../release-notes/" class="md-tabs__link">
        
  
    
  
  Release Notes

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../print_page/" class="md-tabs__link">
        
  
    
  
  Print Site

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="DSG_LIB" class="md-nav__button md-logo" aria-label="DSG_LIB" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    DSG_LIB
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/devsetgo/dsg_lib" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    devsetgo/dsg_lib
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../quickstart/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    QuickStart
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Common Functions
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Common Functions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../common_functions/logging/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Logging
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../common_functions/file_functions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    File Functions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../common_functions/folder_functions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Folder Functions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../common_functions/regex/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RegEx Functions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../common_functions/calendar_functions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Calendar Functions
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    FastAPI Functions
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            FastAPI Functions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fastapi/http_codes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTTP Codes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fastapi/system_health_endpoints/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    System Health
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Database Functions
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Database Functions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../base_schema/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Base Schema
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../database_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Database Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../async_database_setup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Async Database Setup
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Database Operations
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Database Operations
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#configuration-matrix" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration Matrix
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dsg_lib.async_database_functions.database_operations" class="md-nav__link">
    <span class="md-ellipsis">
      database_operations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="database_operations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dsg_lib.async_database_functions.database_operations.DatabaseOperations" class="md-nav__link">
    <span class="md-ellipsis">
      DatabaseOperations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DatabaseOperations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dsg_lib.async_database_functions.database_operations.DatabaseOperations.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dsg_lib.async_database_functions.database_operations.DatabaseOperations.count_query" class="md-nav__link">
    <span class="md-ellipsis">
      count_query
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dsg_lib.async_database_functions.database_operations.DatabaseOperations.create_many" class="md-nav__link">
    <span class="md-ellipsis">
      create_many
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dsg_lib.async_database_functions.database_operations.DatabaseOperations.create_one" class="md-nav__link">
    <span class="md-ellipsis">
      create_one
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dsg_lib.async_database_functions.database_operations.DatabaseOperations.delete_many" class="md-nav__link">
    <span class="md-ellipsis">
      delete_many
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dsg_lib.async_database_functions.database_operations.DatabaseOperations.delete_one" class="md-nav__link">
    <span class="md-ellipsis">
      delete_one
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dsg_lib.async_database_functions.database_operations.DatabaseOperations.get_columns_details" class="md-nav__link">
    <span class="md-ellipsis">
      get_columns_details
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dsg_lib.async_database_functions.database_operations.DatabaseOperations.get_primary_keys" class="md-nav__link">
    <span class="md-ellipsis">
      get_primary_keys
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dsg_lib.async_database_functions.database_operations.DatabaseOperations.get_table_names" class="md-nav__link">
    <span class="md-ellipsis">
      get_table_names
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dsg_lib.async_database_functions.database_operations.DatabaseOperations.read_multi_query" class="md-nav__link">
    <span class="md-ellipsis">
      read_multi_query
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dsg_lib.async_database_functions.database_operations.DatabaseOperations.read_one_record" class="md-nav__link">
    <span class="md-ellipsis">
      read_one_record
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dsg_lib.async_database_functions.database_operations.DatabaseOperations.read_query" class="md-nav__link">
    <span class="md-ellipsis">
      read_query
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dsg_lib.async_database_functions.database_operations.DatabaseOperations.update_one" class="md-nav__link">
    <span class="md-ellipsis">
      update_one
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dsg_lib.async_database_functions.database_operations.handle_exceptions" class="md-nav__link">
    <span class="md-ellipsis">
      handle_exceptions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Recipes
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Recipes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../recipes/fastapi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FastAPI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../recipes/asyncDatabase/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Async Database
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../recipes/loggingExample/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Logging
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../recipes/patterns/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Patterns
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    About
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            About
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contribute/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../release-notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Release Notes
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../print_page/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Print Site
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="reference">Reference<a class="headerlink" href="#reference" title="Permanent link">&para;</a></h1>
<h2 id="configuration-matrix">Configuration Matrix<a class="headerlink" href="#configuration-matrix" title="Permanent link">&para;</a></h2>
<p>Create Engine Support Functions by Database Type Confirmed by testing [SQLITE, PostgreSQL] To Be Tested [MySQL, Oracle, MSSQL] and should be considered experimental.</p>
<table>
<thead>
<tr>
<th>Option</th>
<th>SQLite</th>
<th>PostgreSQL</th>
<th>MySQL</th>
<th>Oracle</th>
<th>MSSQL</th>
</tr>
</thead>
<tbody>
<tr>
<td>echo</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr>
<td>future</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr>
<td>pool_pre_ping</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr>
<td>pool_size</td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr>
<td>max_overflow</td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr>
<td>pool_recycle</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr>
<td>pool_timeout</td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
</tbody>
</table>


<div class="doc doc-object doc-module">



<h2 id="dsg_lib.async_database_functions.database_operations" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>          <code>dsg_lib.async_database_functions.database_operations</code>


<a href="#dsg_lib.async_database_functions.database_operations" class="headerlink" title="Permanent link">&para;</a></h2>

  <div class="doc doc-contents first">
  
      <p>This module contains tests for the DatabaseOperations class in the dsg_lib module.</p>
<p>The DatabaseOperations class provides methods for performing CRUD operations on a database using SQLAlchemy's asynchronous session.</p>
<p>The methods include:</p>
<ul>
<li><code>create_one</code>: Creates a single record in the database.</li>
<li><code>create_many</code>: Creates multiple records in the database.</li>
<li><code>read_one</code>: Reads a single record from the database.</li>
<li><code>read_many</code>: Reads multiple records from the database.</li>
<li><code>update_one</code>: Updates a single record in the database.</li>
<li><code>update_many</code>: Updates multiple records in the database.</li>
<li><code>delete_one</code>: Deletes a single record from the database.</li>
<li><code>delete_many</code>: Deletes multiple records from the database.</li>
<li><code>count_query</code>: Counts the number of records that match a given query.</li>
</ul>
<p>Each method is tested to ensure it performs the expected operation and handles errors correctly. The tests use the pytest-asyncio plugin to run the asynchronous methods in an event loop, and the unittest.mock library to mock the database session and simulate errors.</p>
<p>The tests are organized into a single class, TestDatabaseOperations, which contains one test method for each method in the DatabaseOperations class. Each test method follows the Arrange-Act-Assert pattern: it sets up the necessary objects and state (Arrange), calls the method being tested (Act), and checks that the results are as expected (Assert).</p>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="dsg_lib.async_database_functions.database_operations.DatabaseOperations" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>          <code>DatabaseOperations</code>


<a href="#dsg_lib.async_database_functions.database_operations.DatabaseOperations" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">

  
      <p>This class provides methods for performing CRUD operations on a database using SQLAlchemy's asynchronous session.</p>
<p>The methods include:</p>
<ul>
<li><code>create_one</code>: Creates a single record in the database.</li>
<li><code>create_many</code>: Creates multiple records in the database.</li>
<li><code>read_one</code>: Reads a single record from the database.</li>
<li><code>read_many</code>: Reads multiple records from the database.</li>
<li><code>update_one</code>: Updates a single record in the database.</li>
<li><code>update_many</code>: Updates multiple records in the database.</li>
<li><code>delete_one</code>: Deletes a single record from the database.</li>
<li><code>delete_many</code>: Deletes multiple records from the database.</li>
<li><code>count_query</code>: Counts the number of records that match a given query.</li>
<li><code>get_column_details</code>: Gets the details of the columns in a table.</li>
<li><code>get_primary_keys</code>: Gets the primary keys of a table.</li>
<li><code>get_table_names</code>: Gets the names of all tables in the database.</li>
</ul>
<p>Examples:
<div class="highlight"><pre><span></span><code><span class="n">data</span> <span class="o">=</span> <span class="k">await</span> <span class="n">db_ops</span><span class="o">.</span><span class="n">create_one</span><span class="p">(</span><span class="n">User</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;John Doe&#39;</span><span class="p">))</span>
<span class="n">data</span> <span class="o">=</span> <span class="k">await</span> <span class="n">db_ops</span><span class="o">.</span><span class="n">create_many</span><span class="p">([</span><span class="n">User</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;John Doe&#39;</span><span class="p">),</span> <span class="n">User</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Jane Doe&#39;</span><span class="p">)])</span>
<span class="n">data</span> <span class="o">=</span> <span class="k">await</span> <span class="n">db_ops</span><span class="o">.</span><span class="n">read_one</span><span class="p">(</span><span class="n">User</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="k">await</span> <span class="n">db_ops</span><span class="o">.</span><span class="n">read_many</span><span class="p">(</span><span class="n">User</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">data</span> <span class="o">=</span> <span class="k">await</span> <span class="n">db_ops</span><span class="o">.</span><span class="n">update_one</span><span class="p">(</span><span class="n">User</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;John Smith&#39;</span><span class="p">})</span>
<span class="n">data</span> <span class="o">=</span> <span class="k">await</span> <span class="n">db_ops</span><span class="o">.</span><span class="n">update_many</span><span class="p">(</span><span class="n">User</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;John Smith&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Jane Smith&#39;</span><span class="p">}])</span>
<span class="n">data</span> <span class="o">=</span> <span class="k">await</span> <span class="n">db_ops</span><span class="o">.</span><span class="n">delete_one</span><span class="p">(</span><span class="n">User</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="k">await</span> <span class="n">db_ops</span><span class="o">.</span><span class="n">delete_many</span><span class="p">(</span><span class="n">User</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">data</span> <span class="o">=</span> <span class="k">await</span> <span class="n">db_ops</span><span class="o">.</span><span class="n">count_query</span><span class="p">(</span><span class="n">select</span><span class="p">(</span><span class="n">User</span><span class="p">))</span>
<span class="n">data</span> <span class="o">=</span> <span class="k">await</span> <span class="n">db_ops</span><span class="o">.</span><span class="n">get_column_details</span><span class="p">(</span><span class="n">User</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="k">await</span> <span class="n">db_ops</span><span class="o">.</span><span class="n">get_primary_keys</span><span class="p">(</span><span class="n">User</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="k">await</span> <span class="n">db_ops</span><span class="o">.</span><span class="n">get_table_names</span><span class="p">()</span>
</code></pre></div></p>

            <details class="quote">
              <summary>Source code in <code>dsg_lib/async_database_functions/database_operations.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  99</span>
<span class="normal"> 100</span>
<span class="normal"> 101</span>
<span class="normal"> 102</span>
<span class="normal"> 103</span>
<span class="normal"> 104</span>
<span class="normal"> 105</span>
<span class="normal"> 106</span>
<span class="normal"> 107</span>
<span class="normal"> 108</span>
<span class="normal"> 109</span>
<span class="normal"> 110</span>
<span class="normal"> 111</span>
<span class="normal"> 112</span>
<span class="normal"> 113</span>
<span class="normal"> 114</span>
<span class="normal"> 115</span>
<span class="normal"> 116</span>
<span class="normal"> 117</span>
<span class="normal"> 118</span>
<span class="normal"> 119</span>
<span class="normal"> 120</span>
<span class="normal"> 121</span>
<span class="normal"> 122</span>
<span class="normal"> 123</span>
<span class="normal"> 124</span>
<span class="normal"> 125</span>
<span class="normal"> 126</span>
<span class="normal"> 127</span>
<span class="normal"> 128</span>
<span class="normal"> 129</span>
<span class="normal"> 130</span>
<span class="normal"> 131</span>
<span class="normal"> 132</span>
<span class="normal"> 133</span>
<span class="normal"> 134</span>
<span class="normal"> 135</span>
<span class="normal"> 136</span>
<span class="normal"> 137</span>
<span class="normal"> 138</span>
<span class="normal"> 139</span>
<span class="normal"> 140</span>
<span class="normal"> 141</span>
<span class="normal"> 142</span>
<span class="normal"> 143</span>
<span class="normal"> 144</span>
<span class="normal"> 145</span>
<span class="normal"> 146</span>
<span class="normal"> 147</span>
<span class="normal"> 148</span>
<span class="normal"> 149</span>
<span class="normal"> 150</span>
<span class="normal"> 151</span>
<span class="normal"> 152</span>
<span class="normal"> 153</span>
<span class="normal"> 154</span>
<span class="normal"> 155</span>
<span class="normal"> 156</span>
<span class="normal"> 157</span>
<span class="normal"> 158</span>
<span class="normal"> 159</span>
<span class="normal"> 160</span>
<span class="normal"> 161</span>
<span class="normal"> 162</span>
<span class="normal"> 163</span>
<span class="normal"> 164</span>
<span class="normal"> 165</span>
<span class="normal"> 166</span>
<span class="normal"> 167</span>
<span class="normal"> 168</span>
<span class="normal"> 169</span>
<span class="normal"> 170</span>
<span class="normal"> 171</span>
<span class="normal"> 172</span>
<span class="normal"> 173</span>
<span class="normal"> 174</span>
<span class="normal"> 175</span>
<span class="normal"> 176</span>
<span class="normal"> 177</span>
<span class="normal"> 178</span>
<span class="normal"> 179</span>
<span class="normal"> 180</span>
<span class="normal"> 181</span>
<span class="normal"> 182</span>
<span class="normal"> 183</span>
<span class="normal"> 184</span>
<span class="normal"> 185</span>
<span class="normal"> 186</span>
<span class="normal"> 187</span>
<span class="normal"> 188</span>
<span class="normal"> 189</span>
<span class="normal"> 190</span>
<span class="normal"> 191</span>
<span class="normal"> 192</span>
<span class="normal"> 193</span>
<span class="normal"> 194</span>
<span class="normal"> 195</span>
<span class="normal"> 196</span>
<span class="normal"> 197</span>
<span class="normal"> 198</span>
<span class="normal"> 199</span>
<span class="normal"> 200</span>
<span class="normal"> 201</span>
<span class="normal"> 202</span>
<span class="normal"> 203</span>
<span class="normal"> 204</span>
<span class="normal"> 205</span>
<span class="normal"> 206</span>
<span class="normal"> 207</span>
<span class="normal"> 208</span>
<span class="normal"> 209</span>
<span class="normal"> 210</span>
<span class="normal"> 211</span>
<span class="normal"> 212</span>
<span class="normal"> 213</span>
<span class="normal"> 214</span>
<span class="normal"> 215</span>
<span class="normal"> 216</span>
<span class="normal"> 217</span>
<span class="normal"> 218</span>
<span class="normal"> 219</span>
<span class="normal"> 220</span>
<span class="normal"> 221</span>
<span class="normal"> 222</span>
<span class="normal"> 223</span>
<span class="normal"> 224</span>
<span class="normal"> 225</span>
<span class="normal"> 226</span>
<span class="normal"> 227</span>
<span class="normal"> 228</span>
<span class="normal"> 229</span>
<span class="normal"> 230</span>
<span class="normal"> 231</span>
<span class="normal"> 232</span>
<span class="normal"> 233</span>
<span class="normal"> 234</span>
<span class="normal"> 235</span>
<span class="normal"> 236</span>
<span class="normal"> 237</span>
<span class="normal"> 238</span>
<span class="normal"> 239</span>
<span class="normal"> 240</span>
<span class="normal"> 241</span>
<span class="normal"> 242</span>
<span class="normal"> 243</span>
<span class="normal"> 244</span>
<span class="normal"> 245</span>
<span class="normal"> 246</span>
<span class="normal"> 247</span>
<span class="normal"> 248</span>
<span class="normal"> 249</span>
<span class="normal"> 250</span>
<span class="normal"> 251</span>
<span class="normal"> 252</span>
<span class="normal"> 253</span>
<span class="normal"> 254</span>
<span class="normal"> 255</span>
<span class="normal"> 256</span>
<span class="normal"> 257</span>
<span class="normal"> 258</span>
<span class="normal"> 259</span>
<span class="normal"> 260</span>
<span class="normal"> 261</span>
<span class="normal"> 262</span>
<span class="normal"> 263</span>
<span class="normal"> 264</span>
<span class="normal"> 265</span>
<span class="normal"> 266</span>
<span class="normal"> 267</span>
<span class="normal"> 268</span>
<span class="normal"> 269</span>
<span class="normal"> 270</span>
<span class="normal"> 271</span>
<span class="normal"> 272</span>
<span class="normal"> 273</span>
<span class="normal"> 274</span>
<span class="normal"> 275</span>
<span class="normal"> 276</span>
<span class="normal"> 277</span>
<span class="normal"> 278</span>
<span class="normal"> 279</span>
<span class="normal"> 280</span>
<span class="normal"> 281</span>
<span class="normal"> 282</span>
<span class="normal"> 283</span>
<span class="normal"> 284</span>
<span class="normal"> 285</span>
<span class="normal"> 286</span>
<span class="normal"> 287</span>
<span class="normal"> 288</span>
<span class="normal"> 289</span>
<span class="normal"> 290</span>
<span class="normal"> 291</span>
<span class="normal"> 292</span>
<span class="normal"> 293</span>
<span class="normal"> 294</span>
<span class="normal"> 295</span>
<span class="normal"> 296</span>
<span class="normal"> 297</span>
<span class="normal"> 298</span>
<span class="normal"> 299</span>
<span class="normal"> 300</span>
<span class="normal"> 301</span>
<span class="normal"> 302</span>
<span class="normal"> 303</span>
<span class="normal"> 304</span>
<span class="normal"> 305</span>
<span class="normal"> 306</span>
<span class="normal"> 307</span>
<span class="normal"> 308</span>
<span class="normal"> 309</span>
<span class="normal"> 310</span>
<span class="normal"> 311</span>
<span class="normal"> 312</span>
<span class="normal"> 313</span>
<span class="normal"> 314</span>
<span class="normal"> 315</span>
<span class="normal"> 316</span>
<span class="normal"> 317</span>
<span class="normal"> 318</span>
<span class="normal"> 319</span>
<span class="normal"> 320</span>
<span class="normal"> 321</span>
<span class="normal"> 322</span>
<span class="normal"> 323</span>
<span class="normal"> 324</span>
<span class="normal"> 325</span>
<span class="normal"> 326</span>
<span class="normal"> 327</span>
<span class="normal"> 328</span>
<span class="normal"> 329</span>
<span class="normal"> 330</span>
<span class="normal"> 331</span>
<span class="normal"> 332</span>
<span class="normal"> 333</span>
<span class="normal"> 334</span>
<span class="normal"> 335</span>
<span class="normal"> 336</span>
<span class="normal"> 337</span>
<span class="normal"> 338</span>
<span class="normal"> 339</span>
<span class="normal"> 340</span>
<span class="normal"> 341</span>
<span class="normal"> 342</span>
<span class="normal"> 343</span>
<span class="normal"> 344</span>
<span class="normal"> 345</span>
<span class="normal"> 346</span>
<span class="normal"> 347</span>
<span class="normal"> 348</span>
<span class="normal"> 349</span>
<span class="normal"> 350</span>
<span class="normal"> 351</span>
<span class="normal"> 352</span>
<span class="normal"> 353</span>
<span class="normal"> 354</span>
<span class="normal"> 355</span>
<span class="normal"> 356</span>
<span class="normal"> 357</span>
<span class="normal"> 358</span>
<span class="normal"> 359</span>
<span class="normal"> 360</span>
<span class="normal"> 361</span>
<span class="normal"> 362</span>
<span class="normal"> 363</span>
<span class="normal"> 364</span>
<span class="normal"> 365</span>
<span class="normal"> 366</span>
<span class="normal"> 367</span>
<span class="normal"> 368</span>
<span class="normal"> 369</span>
<span class="normal"> 370</span>
<span class="normal"> 371</span>
<span class="normal"> 372</span>
<span class="normal"> 373</span>
<span class="normal"> 374</span>
<span class="normal"> 375</span>
<span class="normal"> 376</span>
<span class="normal"> 377</span>
<span class="normal"> 378</span>
<span class="normal"> 379</span>
<span class="normal"> 380</span>
<span class="normal"> 381</span>
<span class="normal"> 382</span>
<span class="normal"> 383</span>
<span class="normal"> 384</span>
<span class="normal"> 385</span>
<span class="normal"> 386</span>
<span class="normal"> 387</span>
<span class="normal"> 388</span>
<span class="normal"> 389</span>
<span class="normal"> 390</span>
<span class="normal"> 391</span>
<span class="normal"> 392</span>
<span class="normal"> 393</span>
<span class="normal"> 394</span>
<span class="normal"> 395</span>
<span class="normal"> 396</span>
<span class="normal"> 397</span>
<span class="normal"> 398</span>
<span class="normal"> 399</span>
<span class="normal"> 400</span>
<span class="normal"> 401</span>
<span class="normal"> 402</span>
<span class="normal"> 403</span>
<span class="normal"> 404</span>
<span class="normal"> 405</span>
<span class="normal"> 406</span>
<span class="normal"> 407</span>
<span class="normal"> 408</span>
<span class="normal"> 409</span>
<span class="normal"> 410</span>
<span class="normal"> 411</span>
<span class="normal"> 412</span>
<span class="normal"> 413</span>
<span class="normal"> 414</span>
<span class="normal"> 415</span>
<span class="normal"> 416</span>
<span class="normal"> 417</span>
<span class="normal"> 418</span>
<span class="normal"> 419</span>
<span class="normal"> 420</span>
<span class="normal"> 421</span>
<span class="normal"> 422</span>
<span class="normal"> 423</span>
<span class="normal"> 424</span>
<span class="normal"> 425</span>
<span class="normal"> 426</span>
<span class="normal"> 427</span>
<span class="normal"> 428</span>
<span class="normal"> 429</span>
<span class="normal"> 430</span>
<span class="normal"> 431</span>
<span class="normal"> 432</span>
<span class="normal"> 433</span>
<span class="normal"> 434</span>
<span class="normal"> 435</span>
<span class="normal"> 436</span>
<span class="normal"> 437</span>
<span class="normal"> 438</span>
<span class="normal"> 439</span>
<span class="normal"> 440</span>
<span class="normal"> 441</span>
<span class="normal"> 442</span>
<span class="normal"> 443</span>
<span class="normal"> 444</span>
<span class="normal"> 445</span>
<span class="normal"> 446</span>
<span class="normal"> 447</span>
<span class="normal"> 448</span>
<span class="normal"> 449</span>
<span class="normal"> 450</span>
<span class="normal"> 451</span>
<span class="normal"> 452</span>
<span class="normal"> 453</span>
<span class="normal"> 454</span>
<span class="normal"> 455</span>
<span class="normal"> 456</span>
<span class="normal"> 457</span>
<span class="normal"> 458</span>
<span class="normal"> 459</span>
<span class="normal"> 460</span>
<span class="normal"> 461</span>
<span class="normal"> 462</span>
<span class="normal"> 463</span>
<span class="normal"> 464</span>
<span class="normal"> 465</span>
<span class="normal"> 466</span>
<span class="normal"> 467</span>
<span class="normal"> 468</span>
<span class="normal"> 469</span>
<span class="normal"> 470</span>
<span class="normal"> 471</span>
<span class="normal"> 472</span>
<span class="normal"> 473</span>
<span class="normal"> 474</span>
<span class="normal"> 475</span>
<span class="normal"> 476</span>
<span class="normal"> 477</span>
<span class="normal"> 478</span>
<span class="normal"> 479</span>
<span class="normal"> 480</span>
<span class="normal"> 481</span>
<span class="normal"> 482</span>
<span class="normal"> 483</span>
<span class="normal"> 484</span>
<span class="normal"> 485</span>
<span class="normal"> 486</span>
<span class="normal"> 487</span>
<span class="normal"> 488</span>
<span class="normal"> 489</span>
<span class="normal"> 490</span>
<span class="normal"> 491</span>
<span class="normal"> 492</span>
<span class="normal"> 493</span>
<span class="normal"> 494</span>
<span class="normal"> 495</span>
<span class="normal"> 496</span>
<span class="normal"> 497</span>
<span class="normal"> 498</span>
<span class="normal"> 499</span>
<span class="normal"> 500</span>
<span class="normal"> 501</span>
<span class="normal"> 502</span>
<span class="normal"> 503</span>
<span class="normal"> 504</span>
<span class="normal"> 505</span>
<span class="normal"> 506</span>
<span class="normal"> 507</span>
<span class="normal"> 508</span>
<span class="normal"> 509</span>
<span class="normal"> 510</span>
<span class="normal"> 511</span>
<span class="normal"> 512</span>
<span class="normal"> 513</span>
<span class="normal"> 514</span>
<span class="normal"> 515</span>
<span class="normal"> 516</span>
<span class="normal"> 517</span>
<span class="normal"> 518</span>
<span class="normal"> 519</span>
<span class="normal"> 520</span>
<span class="normal"> 521</span>
<span class="normal"> 522</span>
<span class="normal"> 523</span>
<span class="normal"> 524</span>
<span class="normal"> 525</span>
<span class="normal"> 526</span>
<span class="normal"> 527</span>
<span class="normal"> 528</span>
<span class="normal"> 529</span>
<span class="normal"> 530</span>
<span class="normal"> 531</span>
<span class="normal"> 532</span>
<span class="normal"> 533</span>
<span class="normal"> 534</span>
<span class="normal"> 535</span>
<span class="normal"> 536</span>
<span class="normal"> 537</span>
<span class="normal"> 538</span>
<span class="normal"> 539</span>
<span class="normal"> 540</span>
<span class="normal"> 541</span>
<span class="normal"> 542</span>
<span class="normal"> 543</span>
<span class="normal"> 544</span>
<span class="normal"> 545</span>
<span class="normal"> 546</span>
<span class="normal"> 547</span>
<span class="normal"> 548</span>
<span class="normal"> 549</span>
<span class="normal"> 550</span>
<span class="normal"> 551</span>
<span class="normal"> 552</span>
<span class="normal"> 553</span>
<span class="normal"> 554</span>
<span class="normal"> 555</span>
<span class="normal"> 556</span>
<span class="normal"> 557</span>
<span class="normal"> 558</span>
<span class="normal"> 559</span>
<span class="normal"> 560</span>
<span class="normal"> 561</span>
<span class="normal"> 562</span>
<span class="normal"> 563</span>
<span class="normal"> 564</span>
<span class="normal"> 565</span>
<span class="normal"> 566</span>
<span class="normal"> 567</span>
<span class="normal"> 568</span>
<span class="normal"> 569</span>
<span class="normal"> 570</span>
<span class="normal"> 571</span>
<span class="normal"> 572</span>
<span class="normal"> 573</span>
<span class="normal"> 574</span>
<span class="normal"> 575</span>
<span class="normal"> 576</span>
<span class="normal"> 577</span>
<span class="normal"> 578</span>
<span class="normal"> 579</span>
<span class="normal"> 580</span>
<span class="normal"> 581</span>
<span class="normal"> 582</span>
<span class="normal"> 583</span>
<span class="normal"> 584</span>
<span class="normal"> 585</span>
<span class="normal"> 586</span>
<span class="normal"> 587</span>
<span class="normal"> 588</span>
<span class="normal"> 589</span>
<span class="normal"> 590</span>
<span class="normal"> 591</span>
<span class="normal"> 592</span>
<span class="normal"> 593</span>
<span class="normal"> 594</span>
<span class="normal"> 595</span>
<span class="normal"> 596</span>
<span class="normal"> 597</span>
<span class="normal"> 598</span>
<span class="normal"> 599</span>
<span class="normal"> 600</span>
<span class="normal"> 601</span>
<span class="normal"> 602</span>
<span class="normal"> 603</span>
<span class="normal"> 604</span>
<span class="normal"> 605</span>
<span class="normal"> 606</span>
<span class="normal"> 607</span>
<span class="normal"> 608</span>
<span class="normal"> 609</span>
<span class="normal"> 610</span>
<span class="normal"> 611</span>
<span class="normal"> 612</span>
<span class="normal"> 613</span>
<span class="normal"> 614</span>
<span class="normal"> 615</span>
<span class="normal"> 616</span>
<span class="normal"> 617</span>
<span class="normal"> 618</span>
<span class="normal"> 619</span>
<span class="normal"> 620</span>
<span class="normal"> 621</span>
<span class="normal"> 622</span>
<span class="normal"> 623</span>
<span class="normal"> 624</span>
<span class="normal"> 625</span>
<span class="normal"> 626</span>
<span class="normal"> 627</span>
<span class="normal"> 628</span>
<span class="normal"> 629</span>
<span class="normal"> 630</span>
<span class="normal"> 631</span>
<span class="normal"> 632</span>
<span class="normal"> 633</span>
<span class="normal"> 634</span>
<span class="normal"> 635</span>
<span class="normal"> 636</span>
<span class="normal"> 637</span>
<span class="normal"> 638</span>
<span class="normal"> 639</span>
<span class="normal"> 640</span>
<span class="normal"> 641</span>
<span class="normal"> 642</span>
<span class="normal"> 643</span>
<span class="normal"> 644</span>
<span class="normal"> 645</span>
<span class="normal"> 646</span>
<span class="normal"> 647</span>
<span class="normal"> 648</span>
<span class="normal"> 649</span>
<span class="normal"> 650</span>
<span class="normal"> 651</span>
<span class="normal"> 652</span>
<span class="normal"> 653</span>
<span class="normal"> 654</span>
<span class="normal"> 655</span>
<span class="normal"> 656</span>
<span class="normal"> 657</span>
<span class="normal"> 658</span>
<span class="normal"> 659</span>
<span class="normal"> 660</span>
<span class="normal"> 661</span>
<span class="normal"> 662</span>
<span class="normal"> 663</span>
<span class="normal"> 664</span>
<span class="normal"> 665</span>
<span class="normal"> 666</span>
<span class="normal"> 667</span>
<span class="normal"> 668</span>
<span class="normal"> 669</span>
<span class="normal"> 670</span>
<span class="normal"> 671</span>
<span class="normal"> 672</span>
<span class="normal"> 673</span>
<span class="normal"> 674</span>
<span class="normal"> 675</span>
<span class="normal"> 676</span>
<span class="normal"> 677</span>
<span class="normal"> 678</span>
<span class="normal"> 679</span>
<span class="normal"> 680</span>
<span class="normal"> 681</span>
<span class="normal"> 682</span>
<span class="normal"> 683</span>
<span class="normal"> 684</span>
<span class="normal"> 685</span>
<span class="normal"> 686</span>
<span class="normal"> 687</span>
<span class="normal"> 688</span>
<span class="normal"> 689</span>
<span class="normal"> 690</span>
<span class="normal"> 691</span>
<span class="normal"> 692</span>
<span class="normal"> 693</span>
<span class="normal"> 694</span>
<span class="normal"> 695</span>
<span class="normal"> 696</span>
<span class="normal"> 697</span>
<span class="normal"> 698</span>
<span class="normal"> 699</span>
<span class="normal"> 700</span>
<span class="normal"> 701</span>
<span class="normal"> 702</span>
<span class="normal"> 703</span>
<span class="normal"> 704</span>
<span class="normal"> 705</span>
<span class="normal"> 706</span>
<span class="normal"> 707</span>
<span class="normal"> 708</span>
<span class="normal"> 709</span>
<span class="normal"> 710</span>
<span class="normal"> 711</span>
<span class="normal"> 712</span>
<span class="normal"> 713</span>
<span class="normal"> 714</span>
<span class="normal"> 715</span>
<span class="normal"> 716</span>
<span class="normal"> 717</span>
<span class="normal"> 718</span>
<span class="normal"> 719</span>
<span class="normal"> 720</span>
<span class="normal"> 721</span>
<span class="normal"> 722</span>
<span class="normal"> 723</span>
<span class="normal"> 724</span>
<span class="normal"> 725</span>
<span class="normal"> 726</span>
<span class="normal"> 727</span>
<span class="normal"> 728</span>
<span class="normal"> 729</span>
<span class="normal"> 730</span>
<span class="normal"> 731</span>
<span class="normal"> 732</span>
<span class="normal"> 733</span>
<span class="normal"> 734</span>
<span class="normal"> 735</span>
<span class="normal"> 736</span>
<span class="normal"> 737</span>
<span class="normal"> 738</span>
<span class="normal"> 739</span>
<span class="normal"> 740</span>
<span class="normal"> 741</span>
<span class="normal"> 742</span>
<span class="normal"> 743</span>
<span class="normal"> 744</span>
<span class="normal"> 745</span>
<span class="normal"> 746</span>
<span class="normal"> 747</span>
<span class="normal"> 748</span>
<span class="normal"> 749</span>
<span class="normal"> 750</span>
<span class="normal"> 751</span>
<span class="normal"> 752</span>
<span class="normal"> 753</span>
<span class="normal"> 754</span>
<span class="normal"> 755</span>
<span class="normal"> 756</span>
<span class="normal"> 757</span>
<span class="normal"> 758</span>
<span class="normal"> 759</span>
<span class="normal"> 760</span>
<span class="normal"> 761</span>
<span class="normal"> 762</span>
<span class="normal"> 763</span>
<span class="normal"> 764</span>
<span class="normal"> 765</span>
<span class="normal"> 766</span>
<span class="normal"> 767</span>
<span class="normal"> 768</span>
<span class="normal"> 769</span>
<span class="normal"> 770</span>
<span class="normal"> 771</span>
<span class="normal"> 772</span>
<span class="normal"> 773</span>
<span class="normal"> 774</span>
<span class="normal"> 775</span>
<span class="normal"> 776</span>
<span class="normal"> 777</span>
<span class="normal"> 778</span>
<span class="normal"> 779</span>
<span class="normal"> 780</span>
<span class="normal"> 781</span>
<span class="normal"> 782</span>
<span class="normal"> 783</span>
<span class="normal"> 784</span>
<span class="normal"> 785</span>
<span class="normal"> 786</span>
<span class="normal"> 787</span>
<span class="normal"> 788</span>
<span class="normal"> 789</span>
<span class="normal"> 790</span>
<span class="normal"> 791</span>
<span class="normal"> 792</span>
<span class="normal"> 793</span>
<span class="normal"> 794</span>
<span class="normal"> 795</span>
<span class="normal"> 796</span>
<span class="normal"> 797</span>
<span class="normal"> 798</span>
<span class="normal"> 799</span>
<span class="normal"> 800</span>
<span class="normal"> 801</span>
<span class="normal"> 802</span>
<span class="normal"> 803</span>
<span class="normal"> 804</span>
<span class="normal"> 805</span>
<span class="normal"> 806</span>
<span class="normal"> 807</span>
<span class="normal"> 808</span>
<span class="normal"> 809</span>
<span class="normal"> 810</span>
<span class="normal"> 811</span>
<span class="normal"> 812</span>
<span class="normal"> 813</span>
<span class="normal"> 814</span>
<span class="normal"> 815</span>
<span class="normal"> 816</span>
<span class="normal"> 817</span>
<span class="normal"> 818</span>
<span class="normal"> 819</span>
<span class="normal"> 820</span>
<span class="normal"> 821</span>
<span class="normal"> 822</span>
<span class="normal"> 823</span>
<span class="normal"> 824</span>
<span class="normal"> 825</span>
<span class="normal"> 826</span>
<span class="normal"> 827</span>
<span class="normal"> 828</span>
<span class="normal"> 829</span>
<span class="normal"> 830</span>
<span class="normal"> 831</span>
<span class="normal"> 832</span>
<span class="normal"> 833</span>
<span class="normal"> 834</span>
<span class="normal"> 835</span>
<span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">DatabaseOperations</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class provides methods for performing CRUD operations on a database using SQLAlchemy&#39;s asynchronous session.</span>

<span class="sd">    The methods include:</span>

<span class="sd">    - `create_one`: Creates a single record in the database.</span>
<span class="sd">    - `create_many`: Creates multiple records in the database.</span>
<span class="sd">    - `read_one`: Reads a single record from the database.</span>
<span class="sd">    - `read_many`: Reads multiple records from the database.</span>
<span class="sd">    - `update_one`: Updates a single record in the database.</span>
<span class="sd">    - `update_many`: Updates multiple records in the database.</span>
<span class="sd">    - `delete_one`: Deletes a single record from the database.</span>
<span class="sd">    - `delete_many`: Deletes multiple records from the database.</span>
<span class="sd">    - `count_query`: Counts the number of records that match a given query.</span>
<span class="sd">    - `get_column_details`: Gets the details of the columns in a table.</span>
<span class="sd">    - `get_primary_keys`: Gets the primary keys of a table.</span>
<span class="sd">    - `get_table_names`: Gets the names of all tables in the database.</span>

<span class="sd">    Examples:</span>
<span class="sd">    ```python</span>

<span class="sd">    data = await db_ops.create_one(User(name=&#39;John Doe&#39;))</span>
<span class="sd">    data = await db_ops.create_many([User(name=&#39;John Doe&#39;), User(name=&#39;Jane Doe&#39;)])</span>
<span class="sd">    data = await db_ops.read_one(User, 1)</span>
<span class="sd">    data = await db_ops.read_many(User, [1, 2, 3])</span>
<span class="sd">    data = await db_ops.update_one(User, 1, {&#39;name&#39;: &#39;John Smith&#39;})</span>
<span class="sd">    data = await db_ops.update_many(User, [1, 2], [{&#39;name&#39;: &#39;John Smith&#39;}, {&#39;name&#39;: &#39;Jane Smith&#39;}])</span>
<span class="sd">    data = await db_ops.delete_one(User, 1)</span>
<span class="sd">    data = await db_ops.delete_many(User, [1, 2, 3])</span>
<span class="sd">    data = await db_ops.count_query(select(User))</span>
<span class="sd">    data = await db_ops.get_column_details(User)</span>
<span class="sd">    data = await db_ops.get_primary_keys(User)</span>
<span class="sd">    data = await db_ops.get_table_names()</span>
<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">async_db</span><span class="p">:</span> <span class="n">AsyncDatabase</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes a new instance of the DatabaseOperations class.</span>

<span class="sd">        Args:</span>
<span class="sd">            async_db (module_name.AsyncDatabase): An instance of the</span>
<span class="sd">            AsyncDatabase class for performing asynchronous database operations.</span>

<span class="sd">        Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        from dsg_lib.async_database_functions import (</span>
<span class="sd">        async_database,</span>
<span class="sd">        base_schema,</span>
<span class="sd">        database_config,</span>
<span class="sd">        database_operations,</span>
<span class="sd">        )</span>

<span class="sd">        config = {</span>
<span class="sd">            # &quot;database_uri&quot;: &quot;postgresql+asyncpg://postgres:postgres@postgresdb/postgres&quot;,</span>
<span class="sd">            &quot;database_uri&quot;: &quot;sqlite+aiosqlite:///:memory:?cache=shared&quot;,</span>
<span class="sd">            &quot;echo&quot;: False,</span>
<span class="sd">            &quot;future&quot;: True,</span>
<span class="sd">            # &quot;pool_pre_ping&quot;: True,</span>
<span class="sd">            # &quot;pool_size&quot;: 10,</span>
<span class="sd">            # &quot;max_overflow&quot;: 10,</span>
<span class="sd">            &quot;pool_recycle&quot;: 3600,</span>
<span class="sd">            # &quot;pool_timeout&quot;: 30,</span>
<span class="sd">        }</span>

<span class="sd">        db_config = database_config.DBConfig(config)</span>

<span class="sd">        async_db = async_database.AsyncDatabase(db_config)</span>

<span class="sd">        db_ops = database_operations.DatabaseOperations(async_db)</span>

<span class="sd">        ```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Log the start of the initialization</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Initializing DatabaseOperations instance&#39;</span><span class="p">)</span>

        <span class="c1"># Store the AsyncDatabase instance in the async_db attribute This</span>
        <span class="c1"># instance will be used for performing asynchronous database operations</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">async_db</span> <span class="o">=</span> <span class="n">async_db</span>

        <span class="c1"># Log the successful initialization</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;DatabaseOperations instance initialized successfully&#39;</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_columns_details</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves the details of the columns of a given table.</span>

<span class="sd">        This asynchronous method accepts a table object and returns a</span>
<span class="sd">        dictionary. Each key in the dictionary is a column name from the table,</span>
<span class="sd">        and the corresponding value is another dictionary containing details</span>
<span class="sd">        about that column, such as type, if it&#39;s nullable, if it&#39;s a primary</span>
<span class="sd">        key, if it&#39;s unique, its autoincrement status, and its default value.</span>

<span class="sd">        Args:</span>
<span class="sd">            table (Table): An instance of the SQLAlchemy Table class</span>
<span class="sd">            representing the database table for which column details are</span>
<span class="sd">            required.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: A dictionary where each key is a column name, and each value</span>
<span class="sd">            is a dictionary with the column&#39;s details.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception: If any error occurs during the database operation.</span>

<span class="sd">        Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        from sqlalchemy import Table, MetaData, Column,</span>
<span class="sd">        Integer, String from dsg_lib.async_database_functions import module_name metadata = MetaData()</span>
<span class="sd">        my_table = Table(&#39;my_table&#39;, metadata,</span>
<span class="sd">                        Column(&#39;id&#39;, Integer, primary_key=True), Column(&#39;name&#39;,</span>
<span class="sd">                        String))</span>

<span class="sd">        from dsg_lib.async_database_functions import (</span>
<span class="sd">            async_database,</span>
<span class="sd">            base_schema,</span>
<span class="sd">            database_config,</span>
<span class="sd">            database_operations,</span>
<span class="sd">        )</span>
<span class="sd">        # Create a DBConfig instance</span>
<span class="sd">        config = {</span>
<span class="sd">            # &quot;database_uri&quot;: &quot;postgresql+asyncpg://postgres:postgres@postgresdb/postgres&quot;,</span>
<span class="sd">            &quot;database_uri&quot;: &quot;sqlite+aiosqlite:///:memory:?cache=shared&quot;,</span>
<span class="sd">            &quot;echo&quot;: False,</span>
<span class="sd">            &quot;future&quot;: True,</span>
<span class="sd">            # &quot;pool_pre_ping&quot;: True,</span>
<span class="sd">            # &quot;pool_size&quot;: 10,</span>
<span class="sd">            # &quot;max_overflow&quot;: 10,</span>
<span class="sd">            &quot;pool_recycle&quot;: 3600,</span>
<span class="sd">            # &quot;pool_timeout&quot;: 30,</span>
<span class="sd">        }</span>
<span class="sd">        # create database configuration</span>
<span class="sd">        db_config = database_config.DBConfig(config)</span>
<span class="sd">        # Create an AsyncDatabase instance</span>
<span class="sd">        async_db = async_database.AsyncDatabase(db_config)</span>
<span class="sd">        # Create a DatabaseOperations instance</span>
<span class="sd">        db_ops = database_operations.DatabaseOperations(async_db)</span>
<span class="sd">        # get columns details</span>
<span class="sd">        columns = await db_ops.get_columns_details(my_table)</span>
<span class="sd">        ```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Log the start of the operation</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Starting get_columns_details operation for table: </span><span class="si">{</span><span class="n">table</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Log the start of the column retrieval</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Getting columns for table: </span><span class="si">{</span><span class="n">table</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="c1"># Retrieve the details of the columns and store them in a dictionary</span>
            <span class="c1"># The keys are the column names and the values are dictionaries</span>
            <span class="c1"># containing the column details</span>
            <span class="n">columns</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">type</span><span class="p">),</span>
                    <span class="s1">&#39;nullable&#39;</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">nullable</span><span class="p">,</span>
                    <span class="s1">&#39;primary_key&#39;</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">primary_key</span><span class="p">,</span>
                    <span class="s1">&#39;unique&#39;</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">unique</span><span class="p">,</span>
                    <span class="s1">&#39;autoincrement&#39;</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">autoincrement</span><span class="p">,</span>
                    <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="p">(</span>
                        <span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">default</span><span class="o">.</span><span class="n">arg</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">default</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">callable</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">default</span><span class="o">.</span><span class="n">arg</span><span class="p">)</span>
                        <span class="k">else</span> <span class="kc">None</span>
                    <span class="p">),</span>
                <span class="p">}</span>
                <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">__table__</span><span class="o">.</span><span class="n">columns</span>
            <span class="p">}</span>

            <span class="c1"># Log the successful column retrieval</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Successfully retrieved columns for table: </span><span class="si">{</span><span class="n">table</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">columns</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="c1"># Handle any exceptions that occur during the column retrieval</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                <span class="sa">f</span><span class="s1">&#39;An error occurred while getting columns for table: </span><span class="si">{</span><span class="n">table</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="p">)</span>  <span class="c1"># pragma: no cover</span>
            <span class="k">return</span> <span class="n">handle_exceptions</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>  <span class="c1"># pragma: no cover</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_primary_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves the primary keys of a given table.</span>

<span class="sd">        This asynchronous method accepts a table object and returns a list</span>
<span class="sd">        containing the names of its primary keys. It is useful for understanding</span>
<span class="sd">        the structure of the table and for operations that require knowledge of</span>
<span class="sd">        the primary keys.</span>

<span class="sd">        Args:</span>
<span class="sd">            table (Table): An instance of the SQLAlchemy Table class</span>
<span class="sd">            representing the database table for which primary keys are required.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: A list containing the names of the primary keys of the table.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception: If any error occurs during the database operation.</span>

<span class="sd">        Example:</span>
<span class="sd">            ```python</span>
<span class="sd">            from sqlalchemy import Table, MetaData, Column, Integer,</span>
<span class="sd">                String from dsg_lib.async_database_functions import module_name metadata = MetaData()</span>
<span class="sd">                my_table = Table(&#39;my_table&#39;, metadata,</span>
<span class="sd">                                Column(&#39;id&#39;, Integer, primary_key=True),</span>
<span class="sd">                                Column(&#39;name&#39;, String, primary_key=True))</span>
<span class="sd">            from dsg_lib.async_database_functions import (</span>
<span class="sd">                async_database,</span>
<span class="sd">                base_schema,</span>
<span class="sd">                database_config,</span>
<span class="sd">                database_operations,</span>
<span class="sd">            )</span>
<span class="sd">            # Create a DBConfig instance</span>
<span class="sd">            config = {</span>
<span class="sd">                # &quot;database_uri&quot;: &quot;postgresql+asyncpg://postgres:postgres@postgresdb/postgres&quot;,</span>
<span class="sd">                &quot;database_uri&quot;: &quot;sqlite+aiosqlite:///:memory:?cache=shared&quot;,</span>
<span class="sd">                &quot;echo&quot;: False,</span>
<span class="sd">                &quot;future&quot;: True,</span>
<span class="sd">                # &quot;pool_pre_ping&quot;: True,</span>
<span class="sd">                # &quot;pool_size&quot;: 10,</span>
<span class="sd">                # &quot;max_overflow&quot;: 10,</span>
<span class="sd">                &quot;pool_recycle&quot;: 3600,</span>
<span class="sd">                # &quot;pool_timeout&quot;: 30,</span>
<span class="sd">            }</span>
<span class="sd">            # create database configuration</span>
<span class="sd">            db_config = database_config.DBConfig(config)</span>
<span class="sd">            # Create an AsyncDatabase instance</span>
<span class="sd">            async_db = async_database.AsyncDatabase(db_config)</span>
<span class="sd">            # Create a DatabaseOperations instance</span>
<span class="sd">            db_ops = database_operations.DatabaseOperations(async_db)</span>

<span class="sd">            # get primary keys</span>
<span class="sd">            primary_keys = await db_ops.get_primary_keys(my_table)</span>
<span class="sd">            ```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Log the start of the operation</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Starting get_primary_keys operation for table: </span><span class="si">{</span><span class="n">table</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Log the start of the primary key retrieval</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Getting primary keys for table: </span><span class="si">{</span><span class="n">table</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="c1"># Retrieve the primary keys and store them in a list</span>
            <span class="n">primary_keys</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">__table__</span><span class="o">.</span><span class="n">primary_key</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>

            <span class="c1"># Log the successful primary key retrieval</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Primary keys retrieved successfully: </span><span class="si">{</span><span class="n">primary_keys</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">primary_keys</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="c1"># Handle any exceptions that occur during the primary key retrieval</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Exception occurred: </span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>  <span class="c1"># pragma: no cover</span>
            <span class="k">return</span> <span class="n">handle_exceptions</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>  <span class="c1"># pragma: no cover</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_table_names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves the names of all tables in the database.</span>

<span class="sd">        This asynchronous method returns a list containing the names of all</span>
<span class="sd">        tables in the database. It is useful for database introspection,</span>
<span class="sd">        allowing the user to know which tables are available in the current</span>
<span class="sd">        database context.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: A list containing the names of all tables in the database.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception: If any error occurs during the database operation.</span>

<span class="sd">        Example:</span>
<span class="sd">            ```python</span>
<span class="sd">            from dsg_lib.async_database_functions import (</span>
<span class="sd">            async_database,</span>
<span class="sd">            base_schema,</span>
<span class="sd">            database_config,</span>
<span class="sd">            database_operations,</span>
<span class="sd">            )</span>
<span class="sd">            # Create a DBConfig instance</span>
<span class="sd">            config = {</span>
<span class="sd">                # &quot;database_uri&quot;: &quot;postgresql+asyncpg://postgres:postgres@postgresdb/postgres&quot;,</span>
<span class="sd">                &quot;database_uri&quot;: &quot;sqlite+aiosqlite:///:memory:?cache=shared&quot;,</span>
<span class="sd">                &quot;echo&quot;: False,</span>
<span class="sd">                &quot;future&quot;: True,</span>
<span class="sd">                # &quot;pool_pre_ping&quot;: True,</span>
<span class="sd">                # &quot;pool_size&quot;: 10,</span>
<span class="sd">                # &quot;max_overflow&quot;: 10,</span>
<span class="sd">                &quot;pool_recycle&quot;: 3600,</span>
<span class="sd">                # &quot;pool_timeout&quot;: 30,</span>
<span class="sd">            }</span>
<span class="sd">            # create database configuration</span>
<span class="sd">            db_config = database_config.DBConfig(config)</span>
<span class="sd">            # Create an AsyncDatabase instance</span>
<span class="sd">            async_db = async_database.AsyncDatabase(db_config)</span>
<span class="sd">            # Create a DatabaseOperations instance</span>
<span class="sd">            db_ops = database_operations.DatabaseOperations(async_db)</span>
<span class="sd">            # get table names</span>
<span class="sd">            table_names = await db_ops.get_table_names()</span>
<span class="sd">            ```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Log the start of the operation</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Starting get_table_names operation&#39;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Log the start of the table name retrieval</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Retrieving table names&#39;</span><span class="p">)</span>

            <span class="c1"># Retrieve the table names and store them in a list The keys of the</span>
            <span class="c1"># metadata.tables dictionary are the table names</span>
            <span class="n">table_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">async_db</span><span class="o">.</span><span class="n">Base</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">tables</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

            <span class="c1"># Log the successful table name retrieval</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Table names retrieved successfully: </span><span class="si">{</span><span class="n">table_names</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">table_names</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="c1"># Handle any exceptions that occur during the table name retrieval</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Exception occurred: </span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>  <span class="c1"># pragma: no cover</span>
            <span class="k">return</span> <span class="n">handle_exceptions</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>  <span class="c1"># pragma: no cover</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">read_one_record</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves a single record from the database based on the provided query.</span>

<span class="sd">        This asynchronous method accepts a SQL query object and returns the</span>
<span class="sd">        first record that matches the query. If no record matches the query, it</span>
<span class="sd">        returns None. This method is useful for fetching specific data</span>
<span class="sd">        when the expected result is a single record.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            query (Select): An instance of the SQLAlchemy Select class,</span>
<span class="sd">            representing the query to be executed.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Result: The first record that matches the query or None if no record matches.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception: If any error occurs during the database operation.</span>

<span class="sd">        Example:</span>
<span class="sd">            ```python</span>
<span class="sd">            from dsg_lib.async_database_functions import (</span>
<span class="sd">            async_database,</span>
<span class="sd">            base_schema,</span>
<span class="sd">            database_config,</span>
<span class="sd">            database_operations,</span>
<span class="sd">            )</span>
<span class="sd">            # Create a DBConfig instance</span>
<span class="sd">            config = {</span>
<span class="sd">                # &quot;database_uri&quot;: &quot;postgresql+asyncpg://postgres:postgres@postgresdb/postgres&quot;,</span>
<span class="sd">                &quot;database_uri&quot;: &quot;sqlite+aiosqlite:///:memory:?cache=shared&quot;,</span>
<span class="sd">                &quot;echo&quot;: False,</span>
<span class="sd">                &quot;future&quot;: True,</span>
<span class="sd">                # &quot;pool_pre_ping&quot;: True,</span>
<span class="sd">                # &quot;pool_size&quot;: 10,</span>
<span class="sd">                # &quot;max_overflow&quot;: 10,</span>
<span class="sd">                &quot;pool_recycle&quot;: 3600,</span>
<span class="sd">                # &quot;pool_timeout&quot;: 30,</span>
<span class="sd">            }</span>
<span class="sd">            # create database configuration</span>
<span class="sd">            db_config = database_config.DBConfig(config)</span>
<span class="sd">            # Create an AsyncDatabase instance</span>
<span class="sd">            async_db = async_database.AsyncDatabase(db_config)</span>
<span class="sd">            # Create a DatabaseOperations instance</span>
<span class="sd">            db_ops = database_operations.DatabaseOperations(async_db)</span>
<span class="sd">            # read one record</span>
<span class="sd">            record = await db_ops.read_one_record(select(User).where(User.name == &#39;John Doe&#39;))</span>
<span class="sd">            ```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Log the start of the operation</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Starting read_one_record operation for </span><span class="si">{</span><span class="n">query</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Start a new database session</span>
            <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">async_db</span><span class="o">.</span><span class="n">get_db_session</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
                <span class="c1"># Log the start of the record retrieval</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Getting record with query: </span><span class="si">{</span><span class="n">query</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

                <span class="c1"># Execute the query and retrieve the first record</span>
                <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">session</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
                <span class="n">record</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">scalar_one</span><span class="p">()</span>

                <span class="c1"># Log the successful record retrieval</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Record retrieved successfully: </span><span class="si">{</span><span class="n">record</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

                <span class="k">return</span> <span class="n">record</span>

        <span class="k">except</span> <span class="n">NoResultFound</span><span class="p">:</span>
            <span class="c1"># No record was found</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;No record found&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="c1"># Handle any exceptions that occur during the record retrieval</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Exception occurred: </span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>  <span class="c1"># pragma: no cover</span>
            <span class="k">return</span> <span class="n">handle_exceptions</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>  <span class="c1"># pragma: no cover</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">create_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds a single record to the database.</span>

<span class="sd">        This asynchronous method accepts a record object and adds it to the</span>
<span class="sd">        database. If the operation is successful, it returns the added record.</span>
<span class="sd">        The method is useful for inserting a new row into a database table.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            record (Base): An instance of the SQLAlchemy declarative base class</span>
<span class="sd">            representing the record to be added to the database.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Base: The instance of the record that was added to the database.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception: If any error occurs during the database operation.</span>

<span class="sd">        Example:</span>
<span class="sd">            ```python</span>
<span class="sd">            from dsg_lib.async_database_functions import (</span>
<span class="sd">            async_database,</span>
<span class="sd">            base_schema,</span>
<span class="sd">            database_config,</span>
<span class="sd">            database_operations,</span>
<span class="sd">            )</span>
<span class="sd">            # Create a DBConfig instance</span>
<span class="sd">            config = {</span>
<span class="sd">                # &quot;database_uri&quot;: &quot;postgresql+asyncpg://postgres:postgres@postgresdb/postgres&quot;,</span>
<span class="sd">                &quot;database_uri&quot;: &quot;sqlite+aiosqlite:///:memory:?cache=shared&quot;,</span>
<span class="sd">                &quot;echo&quot;: False,</span>
<span class="sd">                &quot;future&quot;: True,</span>
<span class="sd">                # &quot;pool_pre_ping&quot;: True,</span>
<span class="sd">                # &quot;pool_size&quot;: 10,</span>
<span class="sd">                # &quot;max_overflow&quot;: 10,</span>
<span class="sd">                &quot;pool_recycle&quot;: 3600,</span>
<span class="sd">                # &quot;pool_timeout&quot;: 30,</span>
<span class="sd">            }</span>
<span class="sd">            # create database configuration</span>
<span class="sd">            db_config = database_config.DBConfig(config)</span>
<span class="sd">            # Create an AsyncDatabase instance</span>
<span class="sd">            async_db = async_database.AsyncDatabase(db_config)</span>
<span class="sd">            # Create a DatabaseOperations instance</span>
<span class="sd">            db_ops = database_operations.DatabaseOperations(async_db)</span>
<span class="sd">            # create one record</span>
<span class="sd">            record = await db_ops.create_one(User(name=&#39;John Doe&#39;))</span>
<span class="sd">            ```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Log the start of the operation</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Starting create_one operation&#39;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Start a new database session</span>
            <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">async_db</span><span class="o">.</span><span class="n">get_db_session</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
                <span class="c1"># Log the record being added</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Adding record to session: </span><span class="si">{</span><span class="n">record</span><span class="o">.</span><span class="vm">__dict__</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

                <span class="c1"># Add the record to the session and commit the changes</span>
                <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
                <span class="k">await</span> <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

                <span class="c1"># Log the successful record addition</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Record added successfully: </span><span class="si">{</span><span class="n">record</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

                <span class="k">return</span> <span class="n">record</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
            <span class="c1"># Handle any exceptions that occur during the record addition</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Exception occurred: </span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">handle_exceptions</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">create_many</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">records</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds multiple records to the database.</span>

<span class="sd">        This asynchronous method accepts a list of record objects and adds them</span>
<span class="sd">        to the database. If the operation is successful, it returns the added</span>
<span class="sd">        records. This method is useful for bulk inserting multiple rows into a</span>
<span class="sd">        database table efficiently.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            records (list[Base]): A list of instances of the SQLAlchemy</span>
<span class="sd">            declarative base class, each representing a record to be added to</span>
<span class="sd">            the database.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list[Base]: A list of instances of the records that were added to</span>
<span class="sd">            the database.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception: If any error occurs during the database operation.</span>

<span class="sd">        Example:</span>
<span class="sd">            ```python</span>
<span class="sd">            from dsg_lib.async_database_functions import (</span>
<span class="sd">            async_database,</span>
<span class="sd">            base_schema,</span>
<span class="sd">            database_config,</span>
<span class="sd">            database_operations,</span>
<span class="sd">            )</span>
<span class="sd">            # Create a DBConfig instance</span>
<span class="sd">            config = {</span>
<span class="sd">                # &quot;database_uri&quot;: &quot;postgresql+asyncpg://postgres:postgres@postgresdb/postgres&quot;,</span>
<span class="sd">                &quot;database_uri&quot;: &quot;sqlite+aiosqlite:///:memory:?cache=shared&quot;,</span>
<span class="sd">                &quot;echo&quot;: False,</span>
<span class="sd">                &quot;future&quot;: True,</span>
<span class="sd">                # &quot;pool_pre_ping&quot;: True,</span>
<span class="sd">                # &quot;pool_size&quot;: 10,</span>
<span class="sd">                # &quot;max_overflow&quot;: 10,</span>
<span class="sd">                &quot;pool_recycle&quot;: 3600,</span>
<span class="sd">                # &quot;pool_timeout&quot;: 30,</span>
<span class="sd">            }</span>
<span class="sd">            # create database configuration</span>
<span class="sd">            db_config = database_config.DBConfig(config)</span>
<span class="sd">            # Create an AsyncDatabase instance</span>
<span class="sd">            async_db = async_database.AsyncDatabase(db_config)</span>
<span class="sd">            # Create a DatabaseOperations instance</span>
<span class="sd">            db_ops = database_operations.DatabaseOperations(async_db)</span>
<span class="sd">            # create many records</span>
<span class="sd">            records = await db_ops.create_many([User(name=&#39;John Doe&#39;), User(name=&#39;Jane Doe&#39;)])</span>
<span class="sd">            ```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Log the start of the operation</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Starting create_many operation&#39;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Start a timer to measure the operation time</span>
            <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

            <span class="c1"># Start a new database session</span>
            <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">async_db</span><span class="o">.</span><span class="n">get_db_session</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
                <span class="c1"># Log the number of records being added</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Adding </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">records</span><span class="p">)</span><span class="si">}</span><span class="s1"> records to session&#39;</span><span class="p">)</span>

                <span class="c1"># Add the records to the session and commit the changes</span>
                <span class="n">session</span><span class="o">.</span><span class="n">add_all</span><span class="p">(</span><span class="n">records</span><span class="p">)</span>
                <span class="k">await</span> <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

                <span class="c1"># Log the added records</span>
                <span class="n">records_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">record</span><span class="o">.</span><span class="vm">__dict__</span> <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">records</span><span class="p">]</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Records added to session: </span><span class="si">{</span><span class="n">records_data</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

                <span class="c1"># Calculate the operation time and log the successful record</span>
                <span class="c1"># addition</span>
                <span class="n">num_records</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">records</span><span class="p">)</span>
                <span class="n">t1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">t0</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s1">&#39;Record operations were successful. </span><span class="si">{</span><span class="n">num_records</span><span class="si">}</span><span class="s1"> records were created in </span><span class="si">{</span><span class="n">t1</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1"> seconds.&#39;</span>
                <span class="p">)</span>

                <span class="k">return</span> <span class="n">records</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
            <span class="c1"># Handle any exceptions that occur during the record addition</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Exception occurred: </span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">handle_exceptions</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">count_query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Executes a count query on the database and returns the number of records</span>
<span class="sd">        that match the query.</span>

<span class="sd">        This asynchronous method accepts a SQLAlchemy `Select` query object and</span>
<span class="sd">        returns the count of records that match the query. This is particularly</span>
<span class="sd">        useful for getting the total number of records that satisfy certain</span>
<span class="sd">        conditions without actually fetching the records themselves.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            query (Select): A SQLAlchemy `Select` query object specifying the</span>
<span class="sd">            conditions to count records for.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: The number of records that match the query.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception: If any error occurs during the execution of the query.</span>

<span class="sd">        Example:</span>
<span class="sd">            ```python</span>
<span class="sd">            from dsg_lib.async_database_functions import (</span>
<span class="sd">            async_database,</span>
<span class="sd">            base_schema,</span>
<span class="sd">            database_config,</span>
<span class="sd">            database_operations,</span>
<span class="sd">            )</span>
<span class="sd">            # Create a DBConfig instance</span>
<span class="sd">            config = {</span>
<span class="sd">                # &quot;database_uri&quot;: &quot;postgresql+asyncpg://postgres:postgres@postgresdb/postgres&quot;,</span>
<span class="sd">                &quot;database_uri&quot;: &quot;sqlite+aiosqlite:///:memory:?cache=shared&quot;,</span>
<span class="sd">                &quot;echo&quot;: False,</span>
<span class="sd">                &quot;future&quot;: True,</span>
<span class="sd">                # &quot;pool_pre_ping&quot;: True,</span>
<span class="sd">                # &quot;pool_size&quot;: 10,</span>
<span class="sd">                # &quot;max_overflow&quot;: 10,</span>
<span class="sd">                &quot;pool_recycle&quot;: 3600,</span>
<span class="sd">                # &quot;pool_timeout&quot;: 30,</span>
<span class="sd">            }</span>
<span class="sd">            # create database configuration</span>
<span class="sd">            db_config = database_config.DBConfig(config)</span>
<span class="sd">            # Create an AsyncDatabase instance</span>
<span class="sd">            async_db = async_database.AsyncDatabase(db_config)</span>
<span class="sd">            # Create a DatabaseOperations instance</span>
<span class="sd">            db_ops = database_operations.DatabaseOperations(async_db)</span>
<span class="sd">            # count query</span>
<span class="sd">            count = await db_ops.count_query(select(User).where(User.age &gt; 30))</span>
<span class="sd">            ```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Log the start of the operation</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Starting count_query operation&#39;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Start a new database session</span>
            <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">async_db</span><span class="o">.</span><span class="n">get_db_session</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
                <span class="c1"># Log the query being executed</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Executing count query: </span><span class="si">{</span><span class="n">query</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

                <span class="c1"># Execute the count query and retrieve the count</span>
                <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">session</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">select</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">count</span><span class="p">())</span><span class="o">.</span><span class="n">select_from</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">subquery</span><span class="p">()))</span>
                <span class="n">count</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">scalar</span><span class="p">()</span>

                <span class="c1"># Log the successful query execution</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Count query executed successfully. Result: </span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

                <span class="k">return</span> <span class="n">count</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
            <span class="c1"># Handle any exceptions that occur during the query execution</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Exception occurred: </span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">handle_exceptions</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">read_query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Executes a fetch query on the database and returns a list of records</span>
<span class="sd">        that match the query.</span>

<span class="sd">        This asynchronous method accepts a SQLAlchemy `Select` query object</span>
<span class="sd">        along with optional limit and offset parameters. It returns a list of</span>
<span class="sd">        records that match the query, with the number of records controlled by</span>
<span class="sd">        the limit, and the starting point of the records determined by the</span>
<span class="sd">        offset.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            query (Select): A SQLAlchemy `Select` query object specifying the</span>
<span class="sd">            conditions to fetch records for. limit (int, optional): The maximum</span>
<span class="sd">            number of records to return. Defaults to 500. offset (int,</span>
<span class="sd">            optional): The number of records to skip before starting to return</span>
<span class="sd">            records. Defaults to 0.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: A list of records that match the query.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception: If any error occurs during the execution of the query.</span>

<span class="sd">        Example:</span>
<span class="sd">            ```python</span>
<span class="sd">            from dsg_lib.async_database_functions import (</span>
<span class="sd">            async_database,</span>
<span class="sd">            base_schema,</span>
<span class="sd">            database_config,</span>
<span class="sd">            database_operations,</span>
<span class="sd">            )</span>
<span class="sd">            # Create a DBConfig instance</span>
<span class="sd">            config = {</span>
<span class="sd">                # &quot;database_uri&quot;: &quot;postgresql+asyncpg://postgres:postgres@postgresdb/postgres&quot;,</span>
<span class="sd">                &quot;database_uri&quot;: &quot;sqlite+aiosqlite:///:memory:?cache=shared&quot;,</span>
<span class="sd">                &quot;echo&quot;: False,</span>
<span class="sd">                &quot;future&quot;: True,</span>
<span class="sd">                # &quot;pool_pre_ping&quot;: True,</span>
<span class="sd">                # &quot;pool_size&quot;: 10,</span>
<span class="sd">                # &quot;max_overflow&quot;: 10,</span>
<span class="sd">                &quot;pool_recycle&quot;: 3600,</span>
<span class="sd">                # &quot;pool_timeout&quot;: 30,</span>
<span class="sd">            }</span>
<span class="sd">            # create database configuration</span>
<span class="sd">            db_config = database_config.DBConfig(config)</span>
<span class="sd">            # Create an AsyncDatabase instance</span>
<span class="sd">            async_db = async_database.AsyncDatabase(db_config)</span>
<span class="sd">            # Create a DatabaseOperations instance</span>
<span class="sd">            db_ops = database_operations.DatabaseOperations(async_db)</span>
<span class="sd">            # read query</span>
<span class="sd">            records = await db_ops.read_query(select(User).where(User.age &gt; 30), limit=10)</span>
<span class="sd">            ```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Log the start of the operation</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Starting read_query operation&#39;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Start a new database session</span>
            <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">async_db</span><span class="o">.</span><span class="n">get_db_session</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
                <span class="c1"># Log the query being executed</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s1">&#39;Executing fetch query: </span><span class="si">{</span><span class="n">query</span><span class="si">}</span><span class="s1"> with limit: </span><span class="si">{</span><span class="n">limit</span><span class="si">}</span><span class="s1"> and offset: </span><span class="si">{</span><span class="n">offset</span><span class="si">}</span><span class="s1">&#39;</span>
                <span class="p">)</span>

                <span class="c1"># Execute the fetch query and retrieve the records</span>
                <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">session</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">limit</span><span class="p">)</span><span class="o">.</span><span class="n">offset</span><span class="p">(</span><span class="n">offset</span><span class="p">))</span>
                <span class="n">records</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">scalars</span><span class="p">()</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;read_query result: </span><span class="si">{</span><span class="n">records</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="c1"># Log the successful query execution</span>
                <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">record</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">records</span><span class="p">):</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;read_query result is a tuple </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">records</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="c1"># If all records are tuples, convert them to dictionaries</span>
                    <span class="n">records_data</span> <span class="o">=</span> <span class="p">[</span>
                        <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">((</span><span class="s1">&#39;request_group_id&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">),</span> <span class="n">record</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
                        <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">records</span>
                    <span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;read_query result is a dictionary </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">records</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="c1"># Otherwise, try to convert the records to dictionaries using the __dict__ attribute</span>
                    <span class="n">records_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">record</span><span class="o">.</span><span class="vm">__dict__</span> <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">records</span><span class="p">]</span>

                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Fetch query executed successfully. Records: </span><span class="si">{</span><span class="n">records_data</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

                <span class="k">return</span> <span class="n">records</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
            <span class="c1"># Handle any exceptions that occur during the query execution</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Exception occurred: </span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">handle_exceptions</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">read_multi_query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">queries</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">limit</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Executes multiple fetch queries on the database and returns a dictionary</span>
<span class="sd">        of results for each query.</span>

<span class="sd">        This asynchronous method takes a dictionary where each key is a query</span>
<span class="sd">        name and each value is a SQLAlchemy `Select` query object. It also</span>
<span class="sd">        accepts optional limit and offset parameters. The method executes each</span>
<span class="sd">        query and returns a dictionary where each key is the query name, and the</span>
<span class="sd">        corresponding value is a list of records that match that query.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            queries (Dict[str, Select]): A dictionary of SQLAlchemy `Select`</span>
<span class="sd">            query objects. limit (int, optional): The maximum number of records</span>
<span class="sd">            to return for each query. Defaults to 500. offset (int, optional):</span>
<span class="sd">            The number of records to skip before returning records for each</span>
<span class="sd">            query. Defaults to 0.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: A dictionary where each key is a query name and each value is</span>
<span class="sd">            a list of records that match the query.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception: If any error occurs during the execution of the queries.</span>

<span class="sd">        Example:</span>
<span class="sd">            ```python</span>
<span class="sd">            from dsg_lib.async_database_functions import (</span>
<span class="sd">            async_database,</span>
<span class="sd">            base_schema,</span>
<span class="sd">            database_config,</span>
<span class="sd">            database_operations,</span>
<span class="sd">            )</span>
<span class="sd">            # Create a DBConfig instance</span>
<span class="sd">            config = {</span>
<span class="sd">                # &quot;database_uri&quot;: &quot;postgresql+asyncpg://postgres:postgres@postgresdb/postgres&quot;,</span>
<span class="sd">                &quot;database_uri&quot;: &quot;sqlite+aiosqlite:///:memory:?cache=shared&quot;,</span>
<span class="sd">                &quot;echo&quot;: False,</span>
<span class="sd">                &quot;future&quot;: True,</span>
<span class="sd">                # &quot;pool_pre_ping&quot;: True,</span>
<span class="sd">                # &quot;pool_size&quot;: 10,</span>
<span class="sd">                # &quot;max_overflow&quot;: 10,</span>
<span class="sd">                &quot;pool_recycle&quot;: 3600,</span>
<span class="sd">                # &quot;pool_timeout&quot;: 30,</span>
<span class="sd">            }</span>
<span class="sd">            # create database configuration</span>
<span class="sd">            db_config = database_config.DBConfig(config)</span>
<span class="sd">            # Create an AsyncDatabase instance</span>
<span class="sd">            async_db = async_database.AsyncDatabase(db_config)</span>
<span class="sd">            # Create a DatabaseOperations instance</span>
<span class="sd">            db_ops = database_operations.DatabaseOperations(async_db)</span>
<span class="sd">            # read multi query</span>
<span class="sd">            queries = {</span>
<span class="sd">                &quot;query1&quot;: select(User).where(User.age &gt; 30),</span>
<span class="sd">                &quot;query2&quot;: select(User).where(User.age &lt; 20),</span>
<span class="sd">            }</span>
<span class="sd">            results = await db_ops.read_multi_query(queries, limit=10)</span>
<span class="sd">            ```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Log the start of the operation</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Starting read_multi_query operation&#39;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="c1"># Start a new database session</span>
            <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">async_db</span><span class="o">.</span><span class="n">get_db_session</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">query_name</span><span class="p">,</span> <span class="n">query</span> <span class="ow">in</span> <span class="n">queries</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="c1"># Log the query being executed</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Executing fetch query: </span><span class="si">{</span><span class="n">query</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

                    <span class="c1"># Execute the fetch query and retrieve the records</span>
                    <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">session</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">limit</span><span class="p">)</span><span class="o">.</span><span class="n">offset</span><span class="p">(</span><span class="n">offset</span><span class="p">))</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">scalars</span><span class="p">()</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>

                    <span class="c1"># Convert the records to dictionaries for logging</span>
                    <span class="n">data_dicts</span> <span class="o">=</span> <span class="p">[</span><span class="n">record</span><span class="o">.</span><span class="vm">__dict__</span> <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fetch result for query &#39;</span><span class="si">{</span><span class="n">query_name</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">data_dicts</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

                    <span class="c1"># Log the successful query execution</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s1">&#39;Fetch query executed successfully: </span><span class="si">{</span><span class="n">query_name</span><span class="si">}</span><span class="s1"> with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="s1"> records&#39;</span>
                    <span class="p">)</span>

                    <span class="c1"># Store the records in the results dictionary</span>
                    <span class="n">results</span><span class="p">[</span><span class="n">query_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>
            <span class="k">return</span> <span class="n">results</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
            <span class="c1"># Handle any exceptions that occur during the query execution</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Exception occurred: </span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">handle_exceptions</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">update_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">record_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">new_values</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updates a single record in the database identified by its ID.</span>

<span class="sd">        This asynchronous method takes a SQLAlchemy `Table` object, a record ID,</span>
<span class="sd">        and a dictionary of new values to update the record. It updates the</span>
<span class="sd">        specified record in the given table with the new values. The method does</span>
<span class="sd">        not allow updating certain fields, such as &#39;id&#39; or &#39;date_created&#39;.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            table (Table): The SQLAlchemy `Table` object representing the table</span>
<span class="sd">            in the database. record_id (str): The ID of the record to be</span>
<span class="sd">            updated. new_values (dict): A dictionary containing the fields to</span>
<span class="sd">            update and their new values.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Base: The updated record if successful; otherwise, an error</span>
<span class="sd">            dictionary.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception: If any error occurs during the update operation.</span>

<span class="sd">        Example:</span>
<span class="sd">            ```python</span>
<span class="sd">            from dsg_lib.async_database_functions import (</span>
<span class="sd">            async_database,</span>
<span class="sd">            base_schema,</span>
<span class="sd">            database_config,</span>
<span class="sd">            database_operations,</span>
<span class="sd">            )</span>
<span class="sd">            # Create a DBConfig instance</span>
<span class="sd">            config = {</span>
<span class="sd">                # &quot;database_uri&quot;: &quot;postgresql+asyncpg://postgres:postgres@postgresdb/postgres&quot;,</span>
<span class="sd">                &quot;database_uri&quot;: &quot;sqlite+aiosqlite:///:memory:?cache=shared&quot;,</span>
<span class="sd">                &quot;echo&quot;: False,</span>
<span class="sd">                &quot;future&quot;: True,</span>
<span class="sd">                # &quot;pool_pre_ping&quot;: True,</span>
<span class="sd">                # &quot;pool_size&quot;: 10,</span>
<span class="sd">                # &quot;max_overflow&quot;: 10,</span>
<span class="sd">                &quot;pool_recycle&quot;: 3600,</span>
<span class="sd">                # &quot;pool_timeout&quot;: 30,</span>
<span class="sd">            }</span>
<span class="sd">            # create database configuration</span>
<span class="sd">            db_config = database_config.DBConfig(config)</span>
<span class="sd">            # Create an AsyncDatabase instance</span>
<span class="sd">            async_db = async_database.AsyncDatabase(db_config)</span>
<span class="sd">            # Create a DatabaseOperations instance</span>
<span class="sd">            db_ops = database_operations.DatabaseOperations(async_db)</span>
<span class="sd">            # update one record</span>
<span class="sd">            record = await db_ops.update_one(User, 1, {&#39;name&#39;: &#39;John Smith&#39;})</span>
<span class="sd">            ```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">non_updatable_fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;date_created&#39;</span><span class="p">]</span>

        <span class="c1"># Log the start of the operation</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;Starting update_one operation for record_id: </span><span class="si">{</span><span class="n">record_id</span><span class="si">}</span><span class="s1"> in table: </span><span class="si">{</span><span class="n">table</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Start a new database session</span>
            <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">async_db</span><span class="o">.</span><span class="n">get_db_session</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
                <span class="c1"># Log the record being fetched</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Fetching record with id: </span><span class="si">{</span><span class="n">record_id</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

                <span class="c1"># Fetch the record</span>
                <span class="n">record</span> <span class="o">=</span> <span class="k">await</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">record_id</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">record</span><span class="p">:</span>
                    <span class="c1"># Log the error if no record is found</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;No record found with pkid: </span><span class="si">{</span><span class="n">record_id</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="k">return</span> <span class="p">{</span>
                        <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="s1">&#39;Record not found&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;details&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;No record found with pkid </span><span class="si">{</span><span class="n">record_id</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
                    <span class="p">}</span>

                <span class="c1"># Log the record being updated</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Updating record with new values: </span><span class="si">{</span><span class="n">new_values</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

                <span class="c1"># Update the record with the new values</span>
                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">new_values</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">non_updatable_fields</span><span class="p">:</span>
                        <span class="nb">setattr</span><span class="p">(</span><span class="n">record</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                <span class="k">await</span> <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

                <span class="c1"># Log the successful record update</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Record updated successfully: </span><span class="si">{</span><span class="n">record</span><span class="o">.</span><span class="n">pkid</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">record</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
            <span class="c1"># Handle any exceptions that occur during the record update</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Exception occurred: </span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">handle_exceptions</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">delete_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">record_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Deletes a single record from the database based on the provided table</span>
<span class="sd">        and record ID.</span>

<span class="sd">        This asynchronous method accepts a SQLAlchemy `Table` object and a</span>
<span class="sd">        record ID. It attempts to delete the record with the given ID from the</span>
<span class="sd">        specified table. If the record is successfully deleted, it returns a</span>
<span class="sd">        success message. If no record with the given ID is found, it returns an</span>
<span class="sd">        error message.</span>

<span class="sd">        Args:</span>
<span class="sd">            table (Table): An instance of the SQLAlchemy `Table` class</span>
<span class="sd">            representing the database table from which the record will be</span>
<span class="sd">            deleted. record_id (str): The ID of the record to be deleted.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: A dictionary containing a success message if the record was</span>
<span class="sd">            deleted successfully, or an error message if the record was not</span>
<span class="sd">            found or an exception occurred.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception: If any error occurs during the delete operation.</span>

<span class="sd">        Example:</span>
<span class="sd">            ```python</span>
<span class="sd">            from dsg_lib.async_database_functions import (</span>
<span class="sd">            async_database,</span>
<span class="sd">            base_schema,</span>
<span class="sd">            database_config,</span>
<span class="sd">            database_operations,</span>
<span class="sd">            )</span>
<span class="sd">            # Create a DBConfig instance</span>
<span class="sd">            config = {</span>
<span class="sd">                # &quot;database_uri&quot;: &quot;postgresql+asyncpg://postgres:postgres@postgresdb/postgres&quot;,</span>
<span class="sd">                &quot;database_uri&quot;: &quot;sqlite+aiosqlite:///:memory:?cache=shared&quot;,</span>
<span class="sd">                &quot;echo&quot;: False,</span>
<span class="sd">                &quot;future&quot;: True,</span>
<span class="sd">                # &quot;pool_pre_ping&quot;: True,</span>
<span class="sd">                # &quot;pool_size&quot;: 10,</span>
<span class="sd">                # &quot;max_overflow&quot;: 10,</span>
<span class="sd">                &quot;pool_recycle&quot;: 3600,</span>
<span class="sd">                # &quot;pool_timeout&quot;: 30,</span>
<span class="sd">            }</span>
<span class="sd">            # create database configuration</span>
<span class="sd">            db_config = database_config.DBConfig(config)</span>
<span class="sd">            # Create an AsyncDatabase instance</span>
<span class="sd">            async_db = async_database.AsyncDatabase(db_config)</span>
<span class="sd">            # Create a DatabaseOperations instance</span>
<span class="sd">            db_ops = database_operations.DatabaseOperations(async_db)</span>
<span class="sd">            # delete one record</span>
<span class="sd">            result = await db_ops.delete_one(User, 1)</span>
<span class="sd">            ```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Log the start of the operation</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;Starting delete_one operation for record_id: </span><span class="si">{</span><span class="n">record_id</span><span class="si">}</span><span class="s1"> in table: </span><span class="si">{</span><span class="n">table</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Start a new database session</span>
            <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">async_db</span><span class="o">.</span><span class="n">get_db_session</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
                <span class="c1"># Log the record being fetched</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Fetching record with id: </span><span class="si">{</span><span class="n">record_id</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

                <span class="c1"># Fetch the record</span>
                <span class="n">record</span> <span class="o">=</span> <span class="k">await</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">record_id</span><span class="p">)</span>

                <span class="c1"># If the record doesn&#39;t exist, return an error</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">record</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;No record found with pkid: </span><span class="si">{</span><span class="n">record_id</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="k">return</span> <span class="p">{</span>
                        <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="s1">&#39;Record not found&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;details&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;No record found with pkid </span><span class="si">{</span><span class="n">record_id</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
                    <span class="p">}</span>

                <span class="c1"># Log the record being deleted</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Deleting record with id: </span><span class="si">{</span><span class="n">record_id</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

                <span class="c1"># Delete the record</span>
                <span class="k">await</span> <span class="n">session</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>

                <span class="c1"># Log the successful record deletion from the session</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Record deleted from session: </span><span class="si">{</span><span class="n">record</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

                <span class="c1"># Log the start of the commit</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Committing changes to delete record with id: </span><span class="si">{</span><span class="n">record_id</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

                <span class="c1"># Commit the changes</span>
                <span class="k">await</span> <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

                <span class="c1"># Log the successful record deletion</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Record deleted successfully: </span><span class="si">{</span><span class="n">record_id</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

                <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="s1">&#39;Record deleted successfully&#39;</span><span class="p">}</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
            <span class="c1"># Handle any exceptions that occur during the record deletion</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Exception occurred: </span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">handle_exceptions</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">delete_many</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">table</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">DeclarativeMeta</span><span class="p">],</span>
        <span class="n">id_column_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;pkid&#39;</span><span class="p">,</span>
        <span class="n">id_values</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Deletes multiple records from the specified table in the database.</span>

<span class="sd">        This method takes a table, an optional id column name, and a list of id values. It deletes the records in the table where the id column matches any of the id values in the list.</span>

<span class="sd">        Args:</span>
<span class="sd">            table (Type[DeclarativeMeta]): The table from which to delete records.</span>
<span class="sd">            id_column_name (str, optional): The name of the id column in the table. Defaults to &quot;pkid&quot;.</span>
<span class="sd">            id_values (List[int], optional): A list of id values for the records to delete. Defaults to [].</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: The number of records deleted from the table.</span>

<span class="sd">        Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        from dsg_lib.async_database_functions import (</span>
<span class="sd">            async_database,</span>
<span class="sd">            base_schema,</span>
<span class="sd">            database_config,</span>
<span class="sd">            database_operations,</span>
<span class="sd">        )</span>
<span class="sd">        # Create a DBConfig instance</span>
<span class="sd">        config = {</span>
<span class="sd">            &quot;database_uri&quot;: &quot;sqlite+aiosqlite:///:memory:?cache=shared&quot;,</span>
<span class="sd">            &quot;echo&quot;: False,</span>
<span class="sd">            &quot;future&quot;: True,</span>
<span class="sd">            &quot;pool_recycle&quot;: 3600,</span>
<span class="sd">        }</span>
<span class="sd">        # create database configuration</span>
<span class="sd">        db_config = database_config.DBConfig(config)</span>
<span class="sd">        # Create an AsyncDatabase instance</span>
<span class="sd">        async_db = async_database.AsyncDatabase(db_config)</span>
<span class="sd">        # Create a DatabaseOperations instance</span>
<span class="sd">        db_ops = database_operations.DatabaseOperations(async_db)</span>
<span class="sd">        # Delete multiple records</span>
<span class="sd">        deleted_count = await db_ops.delete_many(User, &#39;id&#39;, [1, 2, 3])</span>
<span class="sd">        print(f&quot;Deleted {deleted_count} records.&quot;)</span>
<span class="sd">        ```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">id_values</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">id_values</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Start a timer to measure the operation time</span>
            <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

            <span class="c1"># Start a new database session</span>
            <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">async_db</span><span class="o">.</span><span class="n">get_db_session</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
                <span class="c1"># Log the number of records being deleted</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Deleting </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">id_values</span><span class="p">)</span><span class="si">}</span><span class="s1"> records from session&#39;</span><span class="p">)</span>

                <span class="c1"># Create delete statement</span>
                <span class="n">stmt</span> <span class="o">=</span> <span class="n">delete</span><span class="p">(</span><span class="n">table</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">id_column_name</span><span class="p">)</span><span class="o">.</span><span class="n">in_</span><span class="p">(</span><span class="n">id_values</span><span class="p">))</span>

                <span class="c1"># Execute the delete statement and fetch result</span>
                <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">session</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>

                <span class="c1"># Commit the changes</span>
                <span class="k">await</span> <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

                <span class="c1"># Get the count of deleted records</span>
                <span class="n">deleted_count</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">rowcount</span>

                <span class="c1"># Log the deleted records</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Records deleted from session: </span><span class="si">{</span><span class="n">deleted_count</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

                <span class="c1"># Calculate the operation time and log the successful record deletion</span>
                <span class="n">t1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">t0</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s1">&#39;Record operations were successful. </span><span class="si">{</span><span class="n">deleted_count</span><span class="si">}</span><span class="s1"> records were deleted in </span><span class="si">{</span><span class="n">t1</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1"> seconds.&#39;</span>
                <span class="p">)</span>

                <span class="k">return</span> <span class="n">deleted_count</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
            <span class="c1"># Handle any exceptions that occur during the record deletion</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Exception occurred: </span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">handle_exceptions</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h4 id="dsg_lib.async_database_functions.database_operations.DatabaseOperations.__init__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">async_db</span><span class="p">)</span></code>

<a href="#dsg_lib.async_database_functions.database_operations.DatabaseOperations.__init__" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Initializes a new instance of the DatabaseOperations class.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>async_db</code></td>
          <td>
                <code><span title="module_name.AsyncDatabase">AsyncDatabase</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An instance of the</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Example:
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">dsg_lib.async_database_functions</span> <span class="kn">import</span> <span class="p">(</span>
<span class="n">async_database</span><span class="p">,</span>
<span class="n">base_schema</span><span class="p">,</span>
<span class="n">database_config</span><span class="p">,</span>
<span class="n">database_operations</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># &quot;database_uri&quot;: &quot;postgresql+asyncpg://postgres:postgres@postgresdb/postgres&quot;,</span>
    <span class="s2">&quot;database_uri&quot;</span><span class="p">:</span> <span class="s2">&quot;sqlite+aiosqlite:///:memory:?cache=shared&quot;</span><span class="p">,</span>
    <span class="s2">&quot;echo&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s2">&quot;future&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="c1"># &quot;pool_pre_ping&quot;: True,</span>
    <span class="c1"># &quot;pool_size&quot;: 10,</span>
    <span class="c1"># &quot;max_overflow&quot;: 10,</span>
    <span class="s2">&quot;pool_recycle&quot;</span><span class="p">:</span> <span class="mi">3600</span><span class="p">,</span>
    <span class="c1"># &quot;pool_timeout&quot;: 30,</span>
<span class="p">}</span>

<span class="n">db_config</span> <span class="o">=</span> <span class="n">database_config</span><span class="o">.</span><span class="n">DBConfig</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>

<span class="n">async_db</span> <span class="o">=</span> <span class="n">async_database</span><span class="o">.</span><span class="n">AsyncDatabase</span><span class="p">(</span><span class="n">db_config</span><span class="p">)</span>

<span class="n">db_ops</span> <span class="o">=</span> <span class="n">database_operations</span><span class="o">.</span><span class="n">DatabaseOperations</span><span class="p">(</span><span class="n">async_db</span><span class="p">)</span>
</code></pre></div></p>

          <details class="quote">
            <summary>Source code in <code>dsg_lib/async_database_functions/database_operations.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">async_db</span><span class="p">:</span> <span class="n">AsyncDatabase</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initializes a new instance of the DatabaseOperations class.</span>

<span class="sd">    Args:</span>
<span class="sd">        async_db (module_name.AsyncDatabase): An instance of the</span>
<span class="sd">        AsyncDatabase class for performing asynchronous database operations.</span>

<span class="sd">    Example:</span>
<span class="sd">    ```python</span>
<span class="sd">    from dsg_lib.async_database_functions import (</span>
<span class="sd">    async_database,</span>
<span class="sd">    base_schema,</span>
<span class="sd">    database_config,</span>
<span class="sd">    database_operations,</span>
<span class="sd">    )</span>

<span class="sd">    config = {</span>
<span class="sd">        # &quot;database_uri&quot;: &quot;postgresql+asyncpg://postgres:postgres@postgresdb/postgres&quot;,</span>
<span class="sd">        &quot;database_uri&quot;: &quot;sqlite+aiosqlite:///:memory:?cache=shared&quot;,</span>
<span class="sd">        &quot;echo&quot;: False,</span>
<span class="sd">        &quot;future&quot;: True,</span>
<span class="sd">        # &quot;pool_pre_ping&quot;: True,</span>
<span class="sd">        # &quot;pool_size&quot;: 10,</span>
<span class="sd">        # &quot;max_overflow&quot;: 10,</span>
<span class="sd">        &quot;pool_recycle&quot;: 3600,</span>
<span class="sd">        # &quot;pool_timeout&quot;: 30,</span>
<span class="sd">    }</span>

<span class="sd">    db_config = database_config.DBConfig(config)</span>

<span class="sd">    async_db = async_database.AsyncDatabase(db_config)</span>

<span class="sd">    db_ops = database_operations.DatabaseOperations(async_db)</span>

<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Log the start of the initialization</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Initializing DatabaseOperations instance&#39;</span><span class="p">)</span>

    <span class="c1"># Store the AsyncDatabase instance in the async_db attribute This</span>
    <span class="c1"># instance will be used for performing asynchronous database operations</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">async_db</span> <span class="o">=</span> <span class="n">async_db</span>

    <span class="c1"># Log the successful initialization</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;DatabaseOperations instance initialized successfully&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="dsg_lib.async_database_functions.database_operations.DatabaseOperations.count_query" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>          <code class="highlight language-python"><span class="n">count_query</span><span class="p">(</span><span class="n">query</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#dsg_lib.async_database_functions.database_operations.DatabaseOperations.count_query" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Executes a count query on the database and returns the number of records
that match the query.</p>
<p>This asynchronous method accepts a SQLAlchemy <code>Select</code> query object and
returns the count of records that match the query. This is particularly
useful for getting the total number of records that satisfy certain
conditions without actually fetching the records themselves.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>query</code></td>
          <td>
                <code>Select</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A SQLAlchemy <code>Select</code> query object specifying the</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
<td><code>int</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The number of records that match the query.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Raises:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
                <code>Exception</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If any error occurs during the execution of the query.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">dsg_lib.async_database_functions</span> <span class="kn">import</span> <span class="p">(</span>
<span class="n">async_database</span><span class="p">,</span>
<span class="n">base_schema</span><span class="p">,</span>
<span class="n">database_config</span><span class="p">,</span>
<span class="n">database_operations</span><span class="p">,</span>
<span class="p">)</span>
<span class="c1"># Create a DBConfig instance</span>
<span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># &quot;database_uri&quot;: &quot;postgresql+asyncpg://postgres:postgres@postgresdb/postgres&quot;,</span>
    <span class="s2">&quot;database_uri&quot;</span><span class="p">:</span> <span class="s2">&quot;sqlite+aiosqlite:///:memory:?cache=shared&quot;</span><span class="p">,</span>
    <span class="s2">&quot;echo&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s2">&quot;future&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="c1"># &quot;pool_pre_ping&quot;: True,</span>
    <span class="c1"># &quot;pool_size&quot;: 10,</span>
    <span class="c1"># &quot;max_overflow&quot;: 10,</span>
    <span class="s2">&quot;pool_recycle&quot;</span><span class="p">:</span> <span class="mi">3600</span><span class="p">,</span>
    <span class="c1"># &quot;pool_timeout&quot;: 30,</span>
<span class="p">}</span>
<span class="c1"># create database configuration</span>
<span class="n">db_config</span> <span class="o">=</span> <span class="n">database_config</span><span class="o">.</span><span class="n">DBConfig</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
<span class="c1"># Create an AsyncDatabase instance</span>
<span class="n">async_db</span> <span class="o">=</span> <span class="n">async_database</span><span class="o">.</span><span class="n">AsyncDatabase</span><span class="p">(</span><span class="n">db_config</span><span class="p">)</span>
<span class="c1"># Create a DatabaseOperations instance</span>
<span class="n">db_ops</span> <span class="o">=</span> <span class="n">database_operations</span><span class="o">.</span><span class="n">DatabaseOperations</span><span class="p">(</span><span class="n">async_db</span><span class="p">)</span>
<span class="c1"># count query</span>
<span class="n">count</span> <span class="o">=</span> <span class="k">await</span> <span class="n">db_ops</span><span class="o">.</span><span class="n">count_query</span><span class="p">(</span><span class="n">select</span><span class="p">(</span><span class="n">User</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">age</span> <span class="o">&gt;</span> <span class="mi">30</span><span class="p">))</span>
</code></pre></div>
</details>
          <details class="quote">
            <summary>Source code in <code>dsg_lib/async_database_functions/database_operations.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">count_query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Executes a count query on the database and returns the number of records</span>
<span class="sd">    that match the query.</span>

<span class="sd">    This asynchronous method accepts a SQLAlchemy `Select` query object and</span>
<span class="sd">    returns the count of records that match the query. This is particularly</span>
<span class="sd">    useful for getting the total number of records that satisfy certain</span>
<span class="sd">    conditions without actually fetching the records themselves.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        query (Select): A SQLAlchemy `Select` query object specifying the</span>
<span class="sd">        conditions to count records for.</span>

<span class="sd">    Returns:</span>
<span class="sd">        int: The number of records that match the query.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: If any error occurs during the execution of the query.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        from dsg_lib.async_database_functions import (</span>
<span class="sd">        async_database,</span>
<span class="sd">        base_schema,</span>
<span class="sd">        database_config,</span>
<span class="sd">        database_operations,</span>
<span class="sd">        )</span>
<span class="sd">        # Create a DBConfig instance</span>
<span class="sd">        config = {</span>
<span class="sd">            # &quot;database_uri&quot;: &quot;postgresql+asyncpg://postgres:postgres@postgresdb/postgres&quot;,</span>
<span class="sd">            &quot;database_uri&quot;: &quot;sqlite+aiosqlite:///:memory:?cache=shared&quot;,</span>
<span class="sd">            &quot;echo&quot;: False,</span>
<span class="sd">            &quot;future&quot;: True,</span>
<span class="sd">            # &quot;pool_pre_ping&quot;: True,</span>
<span class="sd">            # &quot;pool_size&quot;: 10,</span>
<span class="sd">            # &quot;max_overflow&quot;: 10,</span>
<span class="sd">            &quot;pool_recycle&quot;: 3600,</span>
<span class="sd">            # &quot;pool_timeout&quot;: 30,</span>
<span class="sd">        }</span>
<span class="sd">        # create database configuration</span>
<span class="sd">        db_config = database_config.DBConfig(config)</span>
<span class="sd">        # Create an AsyncDatabase instance</span>
<span class="sd">        async_db = async_database.AsyncDatabase(db_config)</span>
<span class="sd">        # Create a DatabaseOperations instance</span>
<span class="sd">        db_ops = database_operations.DatabaseOperations(async_db)</span>
<span class="sd">        # count query</span>
<span class="sd">        count = await db_ops.count_query(select(User).where(User.age &gt; 30))</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Log the start of the operation</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Starting count_query operation&#39;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Start a new database session</span>
        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">async_db</span><span class="o">.</span><span class="n">get_db_session</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
            <span class="c1"># Log the query being executed</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Executing count query: </span><span class="si">{</span><span class="n">query</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="c1"># Execute the count query and retrieve the count</span>
            <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">session</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">select</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">count</span><span class="p">())</span><span class="o">.</span><span class="n">select_from</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">subquery</span><span class="p">()))</span>
            <span class="n">count</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">scalar</span><span class="p">()</span>

            <span class="c1"># Log the successful query execution</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Count query executed successfully. Result: </span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">count</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
        <span class="c1"># Handle any exceptions that occur during the query execution</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Exception occurred: </span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">handle_exceptions</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="dsg_lib.async_database_functions.database_operations.DatabaseOperations.create_many" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>          <code class="highlight language-python"><span class="n">create_many</span><span class="p">(</span><span class="n">records</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#dsg_lib.async_database_functions.database_operations.DatabaseOperations.create_many" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Adds multiple records to the database.</p>
<p>This asynchronous method accepts a list of record objects and adds them
to the database. If the operation is successful, it returns the added
records. This method is useful for bulk inserting multiple rows into a
database table efficiently.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>records</code></td>
          <td>
                <code>list[Base]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of instances of the SQLAlchemy</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>list[Base]: A list of instances of the records that were added to</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the database.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Raises:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
                <code>Exception</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If any error occurs during the database operation.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">dsg_lib.async_database_functions</span> <span class="kn">import</span> <span class="p">(</span>
<span class="n">async_database</span><span class="p">,</span>
<span class="n">base_schema</span><span class="p">,</span>
<span class="n">database_config</span><span class="p">,</span>
<span class="n">database_operations</span><span class="p">,</span>
<span class="p">)</span>
<span class="c1"># Create a DBConfig instance</span>
<span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># &quot;database_uri&quot;: &quot;postgresql+asyncpg://postgres:postgres@postgresdb/postgres&quot;,</span>
    <span class="s2">&quot;database_uri&quot;</span><span class="p">:</span> <span class="s2">&quot;sqlite+aiosqlite:///:memory:?cache=shared&quot;</span><span class="p">,</span>
    <span class="s2">&quot;echo&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s2">&quot;future&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="c1"># &quot;pool_pre_ping&quot;: True,</span>
    <span class="c1"># &quot;pool_size&quot;: 10,</span>
    <span class="c1"># &quot;max_overflow&quot;: 10,</span>
    <span class="s2">&quot;pool_recycle&quot;</span><span class="p">:</span> <span class="mi">3600</span><span class="p">,</span>
    <span class="c1"># &quot;pool_timeout&quot;: 30,</span>
<span class="p">}</span>
<span class="c1"># create database configuration</span>
<span class="n">db_config</span> <span class="o">=</span> <span class="n">database_config</span><span class="o">.</span><span class="n">DBConfig</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
<span class="c1"># Create an AsyncDatabase instance</span>
<span class="n">async_db</span> <span class="o">=</span> <span class="n">async_database</span><span class="o">.</span><span class="n">AsyncDatabase</span><span class="p">(</span><span class="n">db_config</span><span class="p">)</span>
<span class="c1"># Create a DatabaseOperations instance</span>
<span class="n">db_ops</span> <span class="o">=</span> <span class="n">database_operations</span><span class="o">.</span><span class="n">DatabaseOperations</span><span class="p">(</span><span class="n">async_db</span><span class="p">)</span>
<span class="c1"># create many records</span>
<span class="n">records</span> <span class="o">=</span> <span class="k">await</span> <span class="n">db_ops</span><span class="o">.</span><span class="n">create_many</span><span class="p">([</span><span class="n">User</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;John Doe&#39;</span><span class="p">),</span> <span class="n">User</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Jane Doe&#39;</span><span class="p">)])</span>
</code></pre></div>
</details>
          <details class="quote">
            <summary>Source code in <code>dsg_lib/async_database_functions/database_operations.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">create_many</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">records</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds multiple records to the database.</span>

<span class="sd">    This asynchronous method accepts a list of record objects and adds them</span>
<span class="sd">    to the database. If the operation is successful, it returns the added</span>
<span class="sd">    records. This method is useful for bulk inserting multiple rows into a</span>
<span class="sd">    database table efficiently.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        records (list[Base]): A list of instances of the SQLAlchemy</span>
<span class="sd">        declarative base class, each representing a record to be added to</span>
<span class="sd">        the database.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[Base]: A list of instances of the records that were added to</span>
<span class="sd">        the database.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: If any error occurs during the database operation.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        from dsg_lib.async_database_functions import (</span>
<span class="sd">        async_database,</span>
<span class="sd">        base_schema,</span>
<span class="sd">        database_config,</span>
<span class="sd">        database_operations,</span>
<span class="sd">        )</span>
<span class="sd">        # Create a DBConfig instance</span>
<span class="sd">        config = {</span>
<span class="sd">            # &quot;database_uri&quot;: &quot;postgresql+asyncpg://postgres:postgres@postgresdb/postgres&quot;,</span>
<span class="sd">            &quot;database_uri&quot;: &quot;sqlite+aiosqlite:///:memory:?cache=shared&quot;,</span>
<span class="sd">            &quot;echo&quot;: False,</span>
<span class="sd">            &quot;future&quot;: True,</span>
<span class="sd">            # &quot;pool_pre_ping&quot;: True,</span>
<span class="sd">            # &quot;pool_size&quot;: 10,</span>
<span class="sd">            # &quot;max_overflow&quot;: 10,</span>
<span class="sd">            &quot;pool_recycle&quot;: 3600,</span>
<span class="sd">            # &quot;pool_timeout&quot;: 30,</span>
<span class="sd">        }</span>
<span class="sd">        # create database configuration</span>
<span class="sd">        db_config = database_config.DBConfig(config)</span>
<span class="sd">        # Create an AsyncDatabase instance</span>
<span class="sd">        async_db = async_database.AsyncDatabase(db_config)</span>
<span class="sd">        # Create a DatabaseOperations instance</span>
<span class="sd">        db_ops = database_operations.DatabaseOperations(async_db)</span>
<span class="sd">        # create many records</span>
<span class="sd">        records = await db_ops.create_many([User(name=&#39;John Doe&#39;), User(name=&#39;Jane Doe&#39;)])</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Log the start of the operation</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Starting create_many operation&#39;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Start a timer to measure the operation time</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

        <span class="c1"># Start a new database session</span>
        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">async_db</span><span class="o">.</span><span class="n">get_db_session</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
            <span class="c1"># Log the number of records being added</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Adding </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">records</span><span class="p">)</span><span class="si">}</span><span class="s1"> records to session&#39;</span><span class="p">)</span>

            <span class="c1"># Add the records to the session and commit the changes</span>
            <span class="n">session</span><span class="o">.</span><span class="n">add_all</span><span class="p">(</span><span class="n">records</span><span class="p">)</span>
            <span class="k">await</span> <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

            <span class="c1"># Log the added records</span>
            <span class="n">records_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">record</span><span class="o">.</span><span class="vm">__dict__</span> <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">records</span><span class="p">]</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Records added to session: </span><span class="si">{</span><span class="n">records_data</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="c1"># Calculate the operation time and log the successful record</span>
            <span class="c1"># addition</span>
            <span class="n">num_records</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">records</span><span class="p">)</span>
            <span class="n">t1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">t0</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="sa">f</span><span class="s1">&#39;Record operations were successful. </span><span class="si">{</span><span class="n">num_records</span><span class="si">}</span><span class="s1"> records were created in </span><span class="si">{</span><span class="n">t1</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1"> seconds.&#39;</span>
            <span class="p">)</span>

            <span class="k">return</span> <span class="n">records</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
        <span class="c1"># Handle any exceptions that occur during the record addition</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Exception occurred: </span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">handle_exceptions</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="dsg_lib.async_database_functions.database_operations.DatabaseOperations.create_one" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>          <code class="highlight language-python"><span class="n">create_one</span><span class="p">(</span><span class="n">record</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#dsg_lib.async_database_functions.database_operations.DatabaseOperations.create_one" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Adds a single record to the database.</p>
<p>This asynchronous method accepts a record object and adds it to the
database. If the operation is successful, it returns the added record.
The method is useful for inserting a new row into a database table.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>record</code></td>
          <td>
                <code>Base</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An instance of the SQLAlchemy declarative base class</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
<td><code>Base</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The instance of the record that was added to the database.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Raises:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
                <code>Exception</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If any error occurs during the database operation.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">dsg_lib.async_database_functions</span> <span class="kn">import</span> <span class="p">(</span>
<span class="n">async_database</span><span class="p">,</span>
<span class="n">base_schema</span><span class="p">,</span>
<span class="n">database_config</span><span class="p">,</span>
<span class="n">database_operations</span><span class="p">,</span>
<span class="p">)</span>
<span class="c1"># Create a DBConfig instance</span>
<span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># &quot;database_uri&quot;: &quot;postgresql+asyncpg://postgres:postgres@postgresdb/postgres&quot;,</span>
    <span class="s2">&quot;database_uri&quot;</span><span class="p">:</span> <span class="s2">&quot;sqlite+aiosqlite:///:memory:?cache=shared&quot;</span><span class="p">,</span>
    <span class="s2">&quot;echo&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s2">&quot;future&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="c1"># &quot;pool_pre_ping&quot;: True,</span>
    <span class="c1"># &quot;pool_size&quot;: 10,</span>
    <span class="c1"># &quot;max_overflow&quot;: 10,</span>
    <span class="s2">&quot;pool_recycle&quot;</span><span class="p">:</span> <span class="mi">3600</span><span class="p">,</span>
    <span class="c1"># &quot;pool_timeout&quot;: 30,</span>
<span class="p">}</span>
<span class="c1"># create database configuration</span>
<span class="n">db_config</span> <span class="o">=</span> <span class="n">database_config</span><span class="o">.</span><span class="n">DBConfig</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
<span class="c1"># Create an AsyncDatabase instance</span>
<span class="n">async_db</span> <span class="o">=</span> <span class="n">async_database</span><span class="o">.</span><span class="n">AsyncDatabase</span><span class="p">(</span><span class="n">db_config</span><span class="p">)</span>
<span class="c1"># Create a DatabaseOperations instance</span>
<span class="n">db_ops</span> <span class="o">=</span> <span class="n">database_operations</span><span class="o">.</span><span class="n">DatabaseOperations</span><span class="p">(</span><span class="n">async_db</span><span class="p">)</span>
<span class="c1"># create one record</span>
<span class="n">record</span> <span class="o">=</span> <span class="k">await</span> <span class="n">db_ops</span><span class="o">.</span><span class="n">create_one</span><span class="p">(</span><span class="n">User</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;John Doe&#39;</span><span class="p">))</span>
</code></pre></div>
</details>
          <details class="quote">
            <summary>Source code in <code>dsg_lib/async_database_functions/database_operations.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">create_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds a single record to the database.</span>

<span class="sd">    This asynchronous method accepts a record object and adds it to the</span>
<span class="sd">    database. If the operation is successful, it returns the added record.</span>
<span class="sd">    The method is useful for inserting a new row into a database table.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        record (Base): An instance of the SQLAlchemy declarative base class</span>
<span class="sd">        representing the record to be added to the database.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Base: The instance of the record that was added to the database.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: If any error occurs during the database operation.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        from dsg_lib.async_database_functions import (</span>
<span class="sd">        async_database,</span>
<span class="sd">        base_schema,</span>
<span class="sd">        database_config,</span>
<span class="sd">        database_operations,</span>
<span class="sd">        )</span>
<span class="sd">        # Create a DBConfig instance</span>
<span class="sd">        config = {</span>
<span class="sd">            # &quot;database_uri&quot;: &quot;postgresql+asyncpg://postgres:postgres@postgresdb/postgres&quot;,</span>
<span class="sd">            &quot;database_uri&quot;: &quot;sqlite+aiosqlite:///:memory:?cache=shared&quot;,</span>
<span class="sd">            &quot;echo&quot;: False,</span>
<span class="sd">            &quot;future&quot;: True,</span>
<span class="sd">            # &quot;pool_pre_ping&quot;: True,</span>
<span class="sd">            # &quot;pool_size&quot;: 10,</span>
<span class="sd">            # &quot;max_overflow&quot;: 10,</span>
<span class="sd">            &quot;pool_recycle&quot;: 3600,</span>
<span class="sd">            # &quot;pool_timeout&quot;: 30,</span>
<span class="sd">        }</span>
<span class="sd">        # create database configuration</span>
<span class="sd">        db_config = database_config.DBConfig(config)</span>
<span class="sd">        # Create an AsyncDatabase instance</span>
<span class="sd">        async_db = async_database.AsyncDatabase(db_config)</span>
<span class="sd">        # Create a DatabaseOperations instance</span>
<span class="sd">        db_ops = database_operations.DatabaseOperations(async_db)</span>
<span class="sd">        # create one record</span>
<span class="sd">        record = await db_ops.create_one(User(name=&#39;John Doe&#39;))</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Log the start of the operation</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Starting create_one operation&#39;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Start a new database session</span>
        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">async_db</span><span class="o">.</span><span class="n">get_db_session</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
            <span class="c1"># Log the record being added</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Adding record to session: </span><span class="si">{</span><span class="n">record</span><span class="o">.</span><span class="vm">__dict__</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="c1"># Add the record to the session and commit the changes</span>
            <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
            <span class="k">await</span> <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

            <span class="c1"># Log the successful record addition</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Record added successfully: </span><span class="si">{</span><span class="n">record</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">record</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
        <span class="c1"># Handle any exceptions that occur during the record addition</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Exception occurred: </span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">handle_exceptions</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="dsg_lib.async_database_functions.database_operations.DatabaseOperations.delete_many" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>          <code class="highlight language-python"><span class="n">delete_many</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">id_column_name</span><span class="o">=</span><span class="s1">&#39;pkid&#39;</span><span class="p">,</span> <span class="n">id_values</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#dsg_lib.async_database_functions.database_operations.DatabaseOperations.delete_many" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Deletes multiple records from the specified table in the database.</p>
<p>This method takes a table, an optional id column name, and a list of id values. It deletes the records in the table where the id column matches any of the id values in the list.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>table</code></td>
          <td>
                <code><span title="typing.Type">Type</span>[<span title="sqlalchemy.ext.declarative.DeclarativeMeta">DeclarativeMeta</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The table from which to delete records.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>id_column_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The name of the id column in the table. Defaults to "pkid".</p>
            </div>
          </td>
          <td>
                <code>&#39;pkid&#39;</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>id_values</code></td>
          <td>
                <code><span title="typing.List">List</span>[int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of id values for the records to delete. Defaults to [].</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
<td><code>int</code></td>          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The number of records deleted from the table.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Example:
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">dsg_lib.async_database_functions</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">async_database</span><span class="p">,</span>
    <span class="n">base_schema</span><span class="p">,</span>
    <span class="n">database_config</span><span class="p">,</span>
    <span class="n">database_operations</span><span class="p">,</span>
<span class="p">)</span>
<span class="c1"># Create a DBConfig instance</span>
<span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;database_uri&quot;</span><span class="p">:</span> <span class="s2">&quot;sqlite+aiosqlite:///:memory:?cache=shared&quot;</span><span class="p">,</span>
    <span class="s2">&quot;echo&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s2">&quot;future&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s2">&quot;pool_recycle&quot;</span><span class="p">:</span> <span class="mi">3600</span><span class="p">,</span>
<span class="p">}</span>
<span class="c1"># create database configuration</span>
<span class="n">db_config</span> <span class="o">=</span> <span class="n">database_config</span><span class="o">.</span><span class="n">DBConfig</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
<span class="c1"># Create an AsyncDatabase instance</span>
<span class="n">async_db</span> <span class="o">=</span> <span class="n">async_database</span><span class="o">.</span><span class="n">AsyncDatabase</span><span class="p">(</span><span class="n">db_config</span><span class="p">)</span>
<span class="c1"># Create a DatabaseOperations instance</span>
<span class="n">db_ops</span> <span class="o">=</span> <span class="n">database_operations</span><span class="o">.</span><span class="n">DatabaseOperations</span><span class="p">(</span><span class="n">async_db</span><span class="p">)</span>
<span class="c1"># Delete multiple records</span>
<span class="n">deleted_count</span> <span class="o">=</span> <span class="k">await</span> <span class="n">db_ops</span><span class="o">.</span><span class="n">delete_many</span><span class="p">(</span><span class="n">User</span><span class="p">,</span> <span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Deleted </span><span class="si">{</span><span class="n">deleted_count</span><span class="si">}</span><span class="s2"> records.&quot;</span><span class="p">)</span>
</code></pre></div></p>

          <details class="quote">
            <summary>Source code in <code>dsg_lib/async_database_functions/database_operations.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">delete_many</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">table</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">DeclarativeMeta</span><span class="p">],</span>
    <span class="n">id_column_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;pkid&#39;</span><span class="p">,</span>
    <span class="n">id_values</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Deletes multiple records from the specified table in the database.</span>

<span class="sd">    This method takes a table, an optional id column name, and a list of id values. It deletes the records in the table where the id column matches any of the id values in the list.</span>

<span class="sd">    Args:</span>
<span class="sd">        table (Type[DeclarativeMeta]): The table from which to delete records.</span>
<span class="sd">        id_column_name (str, optional): The name of the id column in the table. Defaults to &quot;pkid&quot;.</span>
<span class="sd">        id_values (List[int], optional): A list of id values for the records to delete. Defaults to [].</span>

<span class="sd">    Returns:</span>
<span class="sd">        int: The number of records deleted from the table.</span>

<span class="sd">    Example:</span>
<span class="sd">    ```python</span>
<span class="sd">    from dsg_lib.async_database_functions import (</span>
<span class="sd">        async_database,</span>
<span class="sd">        base_schema,</span>
<span class="sd">        database_config,</span>
<span class="sd">        database_operations,</span>
<span class="sd">    )</span>
<span class="sd">    # Create a DBConfig instance</span>
<span class="sd">    config = {</span>
<span class="sd">        &quot;database_uri&quot;: &quot;sqlite+aiosqlite:///:memory:?cache=shared&quot;,</span>
<span class="sd">        &quot;echo&quot;: False,</span>
<span class="sd">        &quot;future&quot;: True,</span>
<span class="sd">        &quot;pool_recycle&quot;: 3600,</span>
<span class="sd">    }</span>
<span class="sd">    # create database configuration</span>
<span class="sd">    db_config = database_config.DBConfig(config)</span>
<span class="sd">    # Create an AsyncDatabase instance</span>
<span class="sd">    async_db = async_database.AsyncDatabase(db_config)</span>
<span class="sd">    # Create a DatabaseOperations instance</span>
<span class="sd">    db_ops = database_operations.DatabaseOperations(async_db)</span>
<span class="sd">    # Delete multiple records</span>
<span class="sd">    deleted_count = await db_ops.delete_many(User, &#39;id&#39;, [1, 2, 3])</span>
<span class="sd">    print(f&quot;Deleted {deleted_count} records.&quot;)</span>
<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">id_values</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">id_values</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Start a timer to measure the operation time</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

        <span class="c1"># Start a new database session</span>
        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">async_db</span><span class="o">.</span><span class="n">get_db_session</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
            <span class="c1"># Log the number of records being deleted</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Deleting </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">id_values</span><span class="p">)</span><span class="si">}</span><span class="s1"> records from session&#39;</span><span class="p">)</span>

            <span class="c1"># Create delete statement</span>
            <span class="n">stmt</span> <span class="o">=</span> <span class="n">delete</span><span class="p">(</span><span class="n">table</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">id_column_name</span><span class="p">)</span><span class="o">.</span><span class="n">in_</span><span class="p">(</span><span class="n">id_values</span><span class="p">))</span>

            <span class="c1"># Execute the delete statement and fetch result</span>
            <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">session</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>

            <span class="c1"># Commit the changes</span>
            <span class="k">await</span> <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

            <span class="c1"># Get the count of deleted records</span>
            <span class="n">deleted_count</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">rowcount</span>

            <span class="c1"># Log the deleted records</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Records deleted from session: </span><span class="si">{</span><span class="n">deleted_count</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="c1"># Calculate the operation time and log the successful record deletion</span>
            <span class="n">t1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">t0</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="sa">f</span><span class="s1">&#39;Record operations were successful. </span><span class="si">{</span><span class="n">deleted_count</span><span class="si">}</span><span class="s1"> records were deleted in </span><span class="si">{</span><span class="n">t1</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1"> seconds.&#39;</span>
            <span class="p">)</span>

            <span class="k">return</span> <span class="n">deleted_count</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
        <span class="c1"># Handle any exceptions that occur during the record deletion</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Exception occurred: </span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">handle_exceptions</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="dsg_lib.async_database_functions.database_operations.DatabaseOperations.delete_one" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>          <code class="highlight language-python"><span class="n">delete_one</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">record_id</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#dsg_lib.async_database_functions.database_operations.DatabaseOperations.delete_one" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Deletes a single record from the database based on the provided table
and record ID.</p>
<p>This asynchronous method accepts a SQLAlchemy <code>Table</code> object and a
record ID. It attempts to delete the record with the given ID from the
specified table. If the record is successfully deleted, it returns a
success message. If no record with the given ID is found, it returns an
error message.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>table</code></td>
          <td>
                <code>Table</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An instance of the SQLAlchemy <code>Table</code> class</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>deleted.</code></td>
          <td>
                <code>record_id (str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The ID of the record to be deleted.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
<td><code>dict</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dictionary containing a success message if the record was</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
<td></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>deleted successfully, or an error message if the record was not</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
<td></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>found or an exception occurred.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Raises:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
                <code>Exception</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If any error occurs during the delete operation.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">dsg_lib.async_database_functions</span> <span class="kn">import</span> <span class="p">(</span>
<span class="n">async_database</span><span class="p">,</span>
<span class="n">base_schema</span><span class="p">,</span>
<span class="n">database_config</span><span class="p">,</span>
<span class="n">database_operations</span><span class="p">,</span>
<span class="p">)</span>
<span class="c1"># Create a DBConfig instance</span>
<span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># &quot;database_uri&quot;: &quot;postgresql+asyncpg://postgres:postgres@postgresdb/postgres&quot;,</span>
    <span class="s2">&quot;database_uri&quot;</span><span class="p">:</span> <span class="s2">&quot;sqlite+aiosqlite:///:memory:?cache=shared&quot;</span><span class="p">,</span>
    <span class="s2">&quot;echo&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s2">&quot;future&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="c1"># &quot;pool_pre_ping&quot;: True,</span>
    <span class="c1"># &quot;pool_size&quot;: 10,</span>
    <span class="c1"># &quot;max_overflow&quot;: 10,</span>
    <span class="s2">&quot;pool_recycle&quot;</span><span class="p">:</span> <span class="mi">3600</span><span class="p">,</span>
    <span class="c1"># &quot;pool_timeout&quot;: 30,</span>
<span class="p">}</span>
<span class="c1"># create database configuration</span>
<span class="n">db_config</span> <span class="o">=</span> <span class="n">database_config</span><span class="o">.</span><span class="n">DBConfig</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
<span class="c1"># Create an AsyncDatabase instance</span>
<span class="n">async_db</span> <span class="o">=</span> <span class="n">async_database</span><span class="o">.</span><span class="n">AsyncDatabase</span><span class="p">(</span><span class="n">db_config</span><span class="p">)</span>
<span class="c1"># Create a DatabaseOperations instance</span>
<span class="n">db_ops</span> <span class="o">=</span> <span class="n">database_operations</span><span class="o">.</span><span class="n">DatabaseOperations</span><span class="p">(</span><span class="n">async_db</span><span class="p">)</span>
<span class="c1"># delete one record</span>
<span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">db_ops</span><span class="o">.</span><span class="n">delete_one</span><span class="p">(</span><span class="n">User</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div>
</details>
          <details class="quote">
            <summary>Source code in <code>dsg_lib/async_database_functions/database_operations.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">delete_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">record_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Deletes a single record from the database based on the provided table</span>
<span class="sd">    and record ID.</span>

<span class="sd">    This asynchronous method accepts a SQLAlchemy `Table` object and a</span>
<span class="sd">    record ID. It attempts to delete the record with the given ID from the</span>
<span class="sd">    specified table. If the record is successfully deleted, it returns a</span>
<span class="sd">    success message. If no record with the given ID is found, it returns an</span>
<span class="sd">    error message.</span>

<span class="sd">    Args:</span>
<span class="sd">        table (Table): An instance of the SQLAlchemy `Table` class</span>
<span class="sd">        representing the database table from which the record will be</span>
<span class="sd">        deleted. record_id (str): The ID of the record to be deleted.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary containing a success message if the record was</span>
<span class="sd">        deleted successfully, or an error message if the record was not</span>
<span class="sd">        found or an exception occurred.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: If any error occurs during the delete operation.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        from dsg_lib.async_database_functions import (</span>
<span class="sd">        async_database,</span>
<span class="sd">        base_schema,</span>
<span class="sd">        database_config,</span>
<span class="sd">        database_operations,</span>
<span class="sd">        )</span>
<span class="sd">        # Create a DBConfig instance</span>
<span class="sd">        config = {</span>
<span class="sd">            # &quot;database_uri&quot;: &quot;postgresql+asyncpg://postgres:postgres@postgresdb/postgres&quot;,</span>
<span class="sd">            &quot;database_uri&quot;: &quot;sqlite+aiosqlite:///:memory:?cache=shared&quot;,</span>
<span class="sd">            &quot;echo&quot;: False,</span>
<span class="sd">            &quot;future&quot;: True,</span>
<span class="sd">            # &quot;pool_pre_ping&quot;: True,</span>
<span class="sd">            # &quot;pool_size&quot;: 10,</span>
<span class="sd">            # &quot;max_overflow&quot;: 10,</span>
<span class="sd">            &quot;pool_recycle&quot;: 3600,</span>
<span class="sd">            # &quot;pool_timeout&quot;: 30,</span>
<span class="sd">        }</span>
<span class="sd">        # create database configuration</span>
<span class="sd">        db_config = database_config.DBConfig(config)</span>
<span class="sd">        # Create an AsyncDatabase instance</span>
<span class="sd">        async_db = async_database.AsyncDatabase(db_config)</span>
<span class="sd">        # Create a DatabaseOperations instance</span>
<span class="sd">        db_ops = database_operations.DatabaseOperations(async_db)</span>
<span class="sd">        # delete one record</span>
<span class="sd">        result = await db_ops.delete_one(User, 1)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Log the start of the operation</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
        <span class="sa">f</span><span class="s1">&#39;Starting delete_one operation for record_id: </span><span class="si">{</span><span class="n">record_id</span><span class="si">}</span><span class="s1"> in table: </span><span class="si">{</span><span class="n">table</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Start a new database session</span>
        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">async_db</span><span class="o">.</span><span class="n">get_db_session</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
            <span class="c1"># Log the record being fetched</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Fetching record with id: </span><span class="si">{</span><span class="n">record_id</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="c1"># Fetch the record</span>
            <span class="n">record</span> <span class="o">=</span> <span class="k">await</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">record_id</span><span class="p">)</span>

            <span class="c1"># If the record doesn&#39;t exist, return an error</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">record</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;No record found with pkid: </span><span class="si">{</span><span class="n">record_id</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="p">{</span>
                    <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="s1">&#39;Record not found&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;details&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;No record found with pkid </span><span class="si">{</span><span class="n">record_id</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
                <span class="p">}</span>

            <span class="c1"># Log the record being deleted</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Deleting record with id: </span><span class="si">{</span><span class="n">record_id</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="c1"># Delete the record</span>
            <span class="k">await</span> <span class="n">session</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>

            <span class="c1"># Log the successful record deletion from the session</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Record deleted from session: </span><span class="si">{</span><span class="n">record</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="c1"># Log the start of the commit</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Committing changes to delete record with id: </span><span class="si">{</span><span class="n">record_id</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="c1"># Commit the changes</span>
            <span class="k">await</span> <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

            <span class="c1"># Log the successful record deletion</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Record deleted successfully: </span><span class="si">{</span><span class="n">record_id</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="s1">&#39;Record deleted successfully&#39;</span><span class="p">}</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
        <span class="c1"># Handle any exceptions that occur during the record deletion</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Exception occurred: </span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">handle_exceptions</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="dsg_lib.async_database_functions.database_operations.DatabaseOperations.get_columns_details" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>          <code class="highlight language-python"><span class="n">get_columns_details</span><span class="p">(</span><span class="n">table</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#dsg_lib.async_database_functions.database_operations.DatabaseOperations.get_columns_details" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Retrieves the details of the columns of a given table.</p>
<p>This asynchronous method accepts a table object and returns a
dictionary. Each key in the dictionary is a column name from the table,
and the corresponding value is another dictionary containing details
about that column, such as type, if it's nullable, if it's a primary
key, if it's unique, its autoincrement status, and its default value.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>table</code></td>
          <td>
                <code>Table</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An instance of the SQLAlchemy Table class</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
<td><code>dict</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dictionary where each key is a column name, and each value</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
<td></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>is a dictionary with the column's details.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Raises:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
                <code>Exception</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If any error occurs during the database operation.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Example:
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">Table</span><span class="p">,</span> <span class="n">MetaData</span><span class="p">,</span> <span class="n">Column</span><span class="p">,</span>
<span class="n">Integer</span><span class="p">,</span> <span class="n">String</span> <span class="kn">from</span> <span class="nn">dsg_lib.async_database_functions</span> <span class="kn">import</span> <span class="n">module_name</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">MetaData</span><span class="p">()</span>
<span class="n">my_table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="s1">&#39;my_table&#39;</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span>
                <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span>
                <span class="n">String</span><span class="p">))</span>

<span class="kn">from</span> <span class="nn">dsg_lib.async_database_functions</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">async_database</span><span class="p">,</span>
    <span class="n">base_schema</span><span class="p">,</span>
    <span class="n">database_config</span><span class="p">,</span>
    <span class="n">database_operations</span><span class="p">,</span>
<span class="p">)</span>
<span class="c1"># Create a DBConfig instance</span>
<span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># &quot;database_uri&quot;: &quot;postgresql+asyncpg://postgres:postgres@postgresdb/postgres&quot;,</span>
    <span class="s2">&quot;database_uri&quot;</span><span class="p">:</span> <span class="s2">&quot;sqlite+aiosqlite:///:memory:?cache=shared&quot;</span><span class="p">,</span>
    <span class="s2">&quot;echo&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s2">&quot;future&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="c1"># &quot;pool_pre_ping&quot;: True,</span>
    <span class="c1"># &quot;pool_size&quot;: 10,</span>
    <span class="c1"># &quot;max_overflow&quot;: 10,</span>
    <span class="s2">&quot;pool_recycle&quot;</span><span class="p">:</span> <span class="mi">3600</span><span class="p">,</span>
    <span class="c1"># &quot;pool_timeout&quot;: 30,</span>
<span class="p">}</span>
<span class="c1"># create database configuration</span>
<span class="n">db_config</span> <span class="o">=</span> <span class="n">database_config</span><span class="o">.</span><span class="n">DBConfig</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
<span class="c1"># Create an AsyncDatabase instance</span>
<span class="n">async_db</span> <span class="o">=</span> <span class="n">async_database</span><span class="o">.</span><span class="n">AsyncDatabase</span><span class="p">(</span><span class="n">db_config</span><span class="p">)</span>
<span class="c1"># Create a DatabaseOperations instance</span>
<span class="n">db_ops</span> <span class="o">=</span> <span class="n">database_operations</span><span class="o">.</span><span class="n">DatabaseOperations</span><span class="p">(</span><span class="n">async_db</span><span class="p">)</span>
<span class="c1"># get columns details</span>
<span class="n">columns</span> <span class="o">=</span> <span class="k">await</span> <span class="n">db_ops</span><span class="o">.</span><span class="n">get_columns_details</span><span class="p">(</span><span class="n">my_table</span><span class="p">)</span>
</code></pre></div></p>

          <details class="quote">
            <summary>Source code in <code>dsg_lib/async_database_functions/database_operations.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">get_columns_details</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieves the details of the columns of a given table.</span>

<span class="sd">    This asynchronous method accepts a table object and returns a</span>
<span class="sd">    dictionary. Each key in the dictionary is a column name from the table,</span>
<span class="sd">    and the corresponding value is another dictionary containing details</span>
<span class="sd">    about that column, such as type, if it&#39;s nullable, if it&#39;s a primary</span>
<span class="sd">    key, if it&#39;s unique, its autoincrement status, and its default value.</span>

<span class="sd">    Args:</span>
<span class="sd">        table (Table): An instance of the SQLAlchemy Table class</span>
<span class="sd">        representing the database table for which column details are</span>
<span class="sd">        required.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary where each key is a column name, and each value</span>
<span class="sd">        is a dictionary with the column&#39;s details.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: If any error occurs during the database operation.</span>

<span class="sd">    Example:</span>
<span class="sd">    ```python</span>
<span class="sd">    from sqlalchemy import Table, MetaData, Column,</span>
<span class="sd">    Integer, String from dsg_lib.async_database_functions import module_name metadata = MetaData()</span>
<span class="sd">    my_table = Table(&#39;my_table&#39;, metadata,</span>
<span class="sd">                    Column(&#39;id&#39;, Integer, primary_key=True), Column(&#39;name&#39;,</span>
<span class="sd">                    String))</span>

<span class="sd">    from dsg_lib.async_database_functions import (</span>
<span class="sd">        async_database,</span>
<span class="sd">        base_schema,</span>
<span class="sd">        database_config,</span>
<span class="sd">        database_operations,</span>
<span class="sd">    )</span>
<span class="sd">    # Create a DBConfig instance</span>
<span class="sd">    config = {</span>
<span class="sd">        # &quot;database_uri&quot;: &quot;postgresql+asyncpg://postgres:postgres@postgresdb/postgres&quot;,</span>
<span class="sd">        &quot;database_uri&quot;: &quot;sqlite+aiosqlite:///:memory:?cache=shared&quot;,</span>
<span class="sd">        &quot;echo&quot;: False,</span>
<span class="sd">        &quot;future&quot;: True,</span>
<span class="sd">        # &quot;pool_pre_ping&quot;: True,</span>
<span class="sd">        # &quot;pool_size&quot;: 10,</span>
<span class="sd">        # &quot;max_overflow&quot;: 10,</span>
<span class="sd">        &quot;pool_recycle&quot;: 3600,</span>
<span class="sd">        # &quot;pool_timeout&quot;: 30,</span>
<span class="sd">    }</span>
<span class="sd">    # create database configuration</span>
<span class="sd">    db_config = database_config.DBConfig(config)</span>
<span class="sd">    # Create an AsyncDatabase instance</span>
<span class="sd">    async_db = async_database.AsyncDatabase(db_config)</span>
<span class="sd">    # Create a DatabaseOperations instance</span>
<span class="sd">    db_ops = database_operations.DatabaseOperations(async_db)</span>
<span class="sd">    # get columns details</span>
<span class="sd">    columns = await db_ops.get_columns_details(my_table)</span>
<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Log the start of the operation</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Starting get_columns_details operation for table: </span><span class="si">{</span><span class="n">table</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Log the start of the column retrieval</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Getting columns for table: </span><span class="si">{</span><span class="n">table</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="c1"># Retrieve the details of the columns and store them in a dictionary</span>
        <span class="c1"># The keys are the column names and the values are dictionaries</span>
        <span class="c1"># containing the column details</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">type</span><span class="p">),</span>
                <span class="s1">&#39;nullable&#39;</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">nullable</span><span class="p">,</span>
                <span class="s1">&#39;primary_key&#39;</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">primary_key</span><span class="p">,</span>
                <span class="s1">&#39;unique&#39;</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">unique</span><span class="p">,</span>
                <span class="s1">&#39;autoincrement&#39;</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">autoincrement</span><span class="p">,</span>
                <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="p">(</span>
                    <span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">default</span><span class="o">.</span><span class="n">arg</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">default</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">callable</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">default</span><span class="o">.</span><span class="n">arg</span><span class="p">)</span>
                    <span class="k">else</span> <span class="kc">None</span>
                <span class="p">),</span>
            <span class="p">}</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">__table__</span><span class="o">.</span><span class="n">columns</span>
        <span class="p">}</span>

        <span class="c1"># Log the successful column retrieval</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Successfully retrieved columns for table: </span><span class="si">{</span><span class="n">table</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">columns</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
        <span class="c1"># Handle any exceptions that occur during the column retrieval</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;An error occurred while getting columns for table: </span><span class="si">{</span><span class="n">table</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="p">)</span>  <span class="c1"># pragma: no cover</span>
        <span class="k">return</span> <span class="n">handle_exceptions</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>  <span class="c1"># pragma: no cover</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="dsg_lib.async_database_functions.database_operations.DatabaseOperations.get_primary_keys" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>          <code class="highlight language-python"><span class="n">get_primary_keys</span><span class="p">(</span><span class="n">table</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#dsg_lib.async_database_functions.database_operations.DatabaseOperations.get_primary_keys" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Retrieves the primary keys of a given table.</p>
<p>This asynchronous method accepts a table object and returns a list
containing the names of its primary keys. It is useful for understanding
the structure of the table and for operations that require knowledge of
the primary keys.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>table</code></td>
          <td>
                <code>Table</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An instance of the SQLAlchemy Table class</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
<td><code>list</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list containing the names of the primary keys of the table.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Raises:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
                <code>Exception</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If any error occurs during the database operation.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">Table</span><span class="p">,</span> <span class="n">MetaData</span><span class="p">,</span> <span class="n">Column</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span>
    <span class="n">String</span> <span class="kn">from</span> <span class="nn">dsg_lib.async_database_functions</span> <span class="kn">import</span> <span class="n">module_name</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">MetaData</span><span class="p">()</span>
    <span class="n">my_table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="s1">&#39;my_table&#39;</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span>
                    <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                    <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">String</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="kn">from</span> <span class="nn">dsg_lib.async_database_functions</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">async_database</span><span class="p">,</span>
    <span class="n">base_schema</span><span class="p">,</span>
    <span class="n">database_config</span><span class="p">,</span>
    <span class="n">database_operations</span><span class="p">,</span>
<span class="p">)</span>
<span class="c1"># Create a DBConfig instance</span>
<span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># &quot;database_uri&quot;: &quot;postgresql+asyncpg://postgres:postgres@postgresdb/postgres&quot;,</span>
    <span class="s2">&quot;database_uri&quot;</span><span class="p">:</span> <span class="s2">&quot;sqlite+aiosqlite:///:memory:?cache=shared&quot;</span><span class="p">,</span>
    <span class="s2">&quot;echo&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s2">&quot;future&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="c1"># &quot;pool_pre_ping&quot;: True,</span>
    <span class="c1"># &quot;pool_size&quot;: 10,</span>
    <span class="c1"># &quot;max_overflow&quot;: 10,</span>
    <span class="s2">&quot;pool_recycle&quot;</span><span class="p">:</span> <span class="mi">3600</span><span class="p">,</span>
    <span class="c1"># &quot;pool_timeout&quot;: 30,</span>
<span class="p">}</span>
<span class="c1"># create database configuration</span>
<span class="n">db_config</span> <span class="o">=</span> <span class="n">database_config</span><span class="o">.</span><span class="n">DBConfig</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
<span class="c1"># Create an AsyncDatabase instance</span>
<span class="n">async_db</span> <span class="o">=</span> <span class="n">async_database</span><span class="o">.</span><span class="n">AsyncDatabase</span><span class="p">(</span><span class="n">db_config</span><span class="p">)</span>
<span class="c1"># Create a DatabaseOperations instance</span>
<span class="n">db_ops</span> <span class="o">=</span> <span class="n">database_operations</span><span class="o">.</span><span class="n">DatabaseOperations</span><span class="p">(</span><span class="n">async_db</span><span class="p">)</span>

<span class="c1"># get primary keys</span>
<span class="n">primary_keys</span> <span class="o">=</span> <span class="k">await</span> <span class="n">db_ops</span><span class="o">.</span><span class="n">get_primary_keys</span><span class="p">(</span><span class="n">my_table</span><span class="p">)</span>
</code></pre></div>
</details>
          <details class="quote">
            <summary>Source code in <code>dsg_lib/async_database_functions/database_operations.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">get_primary_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieves the primary keys of a given table.</span>

<span class="sd">    This asynchronous method accepts a table object and returns a list</span>
<span class="sd">    containing the names of its primary keys. It is useful for understanding</span>
<span class="sd">    the structure of the table and for operations that require knowledge of</span>
<span class="sd">    the primary keys.</span>

<span class="sd">    Args:</span>
<span class="sd">        table (Table): An instance of the SQLAlchemy Table class</span>
<span class="sd">        representing the database table for which primary keys are required.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: A list containing the names of the primary keys of the table.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: If any error occurs during the database operation.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        from sqlalchemy import Table, MetaData, Column, Integer,</span>
<span class="sd">            String from dsg_lib.async_database_functions import module_name metadata = MetaData()</span>
<span class="sd">            my_table = Table(&#39;my_table&#39;, metadata,</span>
<span class="sd">                            Column(&#39;id&#39;, Integer, primary_key=True),</span>
<span class="sd">                            Column(&#39;name&#39;, String, primary_key=True))</span>
<span class="sd">        from dsg_lib.async_database_functions import (</span>
<span class="sd">            async_database,</span>
<span class="sd">            base_schema,</span>
<span class="sd">            database_config,</span>
<span class="sd">            database_operations,</span>
<span class="sd">        )</span>
<span class="sd">        # Create a DBConfig instance</span>
<span class="sd">        config = {</span>
<span class="sd">            # &quot;database_uri&quot;: &quot;postgresql+asyncpg://postgres:postgres@postgresdb/postgres&quot;,</span>
<span class="sd">            &quot;database_uri&quot;: &quot;sqlite+aiosqlite:///:memory:?cache=shared&quot;,</span>
<span class="sd">            &quot;echo&quot;: False,</span>
<span class="sd">            &quot;future&quot;: True,</span>
<span class="sd">            # &quot;pool_pre_ping&quot;: True,</span>
<span class="sd">            # &quot;pool_size&quot;: 10,</span>
<span class="sd">            # &quot;max_overflow&quot;: 10,</span>
<span class="sd">            &quot;pool_recycle&quot;: 3600,</span>
<span class="sd">            # &quot;pool_timeout&quot;: 30,</span>
<span class="sd">        }</span>
<span class="sd">        # create database configuration</span>
<span class="sd">        db_config = database_config.DBConfig(config)</span>
<span class="sd">        # Create an AsyncDatabase instance</span>
<span class="sd">        async_db = async_database.AsyncDatabase(db_config)</span>
<span class="sd">        # Create a DatabaseOperations instance</span>
<span class="sd">        db_ops = database_operations.DatabaseOperations(async_db)</span>

<span class="sd">        # get primary keys</span>
<span class="sd">        primary_keys = await db_ops.get_primary_keys(my_table)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Log the start of the operation</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Starting get_primary_keys operation for table: </span><span class="si">{</span><span class="n">table</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Log the start of the primary key retrieval</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Getting primary keys for table: </span><span class="si">{</span><span class="n">table</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="c1"># Retrieve the primary keys and store them in a list</span>
        <span class="n">primary_keys</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">__table__</span><span class="o">.</span><span class="n">primary_key</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>

        <span class="c1"># Log the successful primary key retrieval</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Primary keys retrieved successfully: </span><span class="si">{</span><span class="n">primary_keys</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">primary_keys</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
        <span class="c1"># Handle any exceptions that occur during the primary key retrieval</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Exception occurred: </span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>  <span class="c1"># pragma: no cover</span>
        <span class="k">return</span> <span class="n">handle_exceptions</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>  <span class="c1"># pragma: no cover</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="dsg_lib.async_database_functions.database_operations.DatabaseOperations.get_table_names" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>          <code class="highlight language-python"><span class="n">get_table_names</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#dsg_lib.async_database_functions.database_operations.DatabaseOperations.get_table_names" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Retrieves the names of all tables in the database.</p>
<p>This asynchronous method returns a list containing the names of all
tables in the database. It is useful for database introspection,
allowing the user to know which tables are available in the current
database context.</p>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
<td><code>list</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list containing the names of all tables in the database.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Raises:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
                <code>Exception</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If any error occurs during the database operation.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">dsg_lib.async_database_functions</span> <span class="kn">import</span> <span class="p">(</span>
<span class="n">async_database</span><span class="p">,</span>
<span class="n">base_schema</span><span class="p">,</span>
<span class="n">database_config</span><span class="p">,</span>
<span class="n">database_operations</span><span class="p">,</span>
<span class="p">)</span>
<span class="c1"># Create a DBConfig instance</span>
<span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># &quot;database_uri&quot;: &quot;postgresql+asyncpg://postgres:postgres@postgresdb/postgres&quot;,</span>
    <span class="s2">&quot;database_uri&quot;</span><span class="p">:</span> <span class="s2">&quot;sqlite+aiosqlite:///:memory:?cache=shared&quot;</span><span class="p">,</span>
    <span class="s2">&quot;echo&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s2">&quot;future&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="c1"># &quot;pool_pre_ping&quot;: True,</span>
    <span class="c1"># &quot;pool_size&quot;: 10,</span>
    <span class="c1"># &quot;max_overflow&quot;: 10,</span>
    <span class="s2">&quot;pool_recycle&quot;</span><span class="p">:</span> <span class="mi">3600</span><span class="p">,</span>
    <span class="c1"># &quot;pool_timeout&quot;: 30,</span>
<span class="p">}</span>
<span class="c1"># create database configuration</span>
<span class="n">db_config</span> <span class="o">=</span> <span class="n">database_config</span><span class="o">.</span><span class="n">DBConfig</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
<span class="c1"># Create an AsyncDatabase instance</span>
<span class="n">async_db</span> <span class="o">=</span> <span class="n">async_database</span><span class="o">.</span><span class="n">AsyncDatabase</span><span class="p">(</span><span class="n">db_config</span><span class="p">)</span>
<span class="c1"># Create a DatabaseOperations instance</span>
<span class="n">db_ops</span> <span class="o">=</span> <span class="n">database_operations</span><span class="o">.</span><span class="n">DatabaseOperations</span><span class="p">(</span><span class="n">async_db</span><span class="p">)</span>
<span class="c1"># get table names</span>
<span class="n">table_names</span> <span class="o">=</span> <span class="k">await</span> <span class="n">db_ops</span><span class="o">.</span><span class="n">get_table_names</span><span class="p">()</span>
</code></pre></div>
</details>
          <details class="quote">
            <summary>Source code in <code>dsg_lib/async_database_functions/database_operations.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">get_table_names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieves the names of all tables in the database.</span>

<span class="sd">    This asynchronous method returns a list containing the names of all</span>
<span class="sd">    tables in the database. It is useful for database introspection,</span>
<span class="sd">    allowing the user to know which tables are available in the current</span>
<span class="sd">    database context.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: A list containing the names of all tables in the database.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: If any error occurs during the database operation.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        from dsg_lib.async_database_functions import (</span>
<span class="sd">        async_database,</span>
<span class="sd">        base_schema,</span>
<span class="sd">        database_config,</span>
<span class="sd">        database_operations,</span>
<span class="sd">        )</span>
<span class="sd">        # Create a DBConfig instance</span>
<span class="sd">        config = {</span>
<span class="sd">            # &quot;database_uri&quot;: &quot;postgresql+asyncpg://postgres:postgres@postgresdb/postgres&quot;,</span>
<span class="sd">            &quot;database_uri&quot;: &quot;sqlite+aiosqlite:///:memory:?cache=shared&quot;,</span>
<span class="sd">            &quot;echo&quot;: False,</span>
<span class="sd">            &quot;future&quot;: True,</span>
<span class="sd">            # &quot;pool_pre_ping&quot;: True,</span>
<span class="sd">            # &quot;pool_size&quot;: 10,</span>
<span class="sd">            # &quot;max_overflow&quot;: 10,</span>
<span class="sd">            &quot;pool_recycle&quot;: 3600,</span>
<span class="sd">            # &quot;pool_timeout&quot;: 30,</span>
<span class="sd">        }</span>
<span class="sd">        # create database configuration</span>
<span class="sd">        db_config = database_config.DBConfig(config)</span>
<span class="sd">        # Create an AsyncDatabase instance</span>
<span class="sd">        async_db = async_database.AsyncDatabase(db_config)</span>
<span class="sd">        # Create a DatabaseOperations instance</span>
<span class="sd">        db_ops = database_operations.DatabaseOperations(async_db)</span>
<span class="sd">        # get table names</span>
<span class="sd">        table_names = await db_ops.get_table_names()</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Log the start of the operation</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Starting get_table_names operation&#39;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Log the start of the table name retrieval</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Retrieving table names&#39;</span><span class="p">)</span>

        <span class="c1"># Retrieve the table names and store them in a list The keys of the</span>
        <span class="c1"># metadata.tables dictionary are the table names</span>
        <span class="n">table_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">async_db</span><span class="o">.</span><span class="n">Base</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">tables</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

        <span class="c1"># Log the successful table name retrieval</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Table names retrieved successfully: </span><span class="si">{</span><span class="n">table_names</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">table_names</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
        <span class="c1"># Handle any exceptions that occur during the table name retrieval</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Exception occurred: </span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>  <span class="c1"># pragma: no cover</span>
        <span class="k">return</span> <span class="n">handle_exceptions</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>  <span class="c1"># pragma: no cover</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="dsg_lib.async_database_functions.database_operations.DatabaseOperations.read_multi_query" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>          <code class="highlight language-python"><span class="n">read_multi_query</span><span class="p">(</span><span class="n">queries</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#dsg_lib.async_database_functions.database_operations.DatabaseOperations.read_multi_query" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Executes multiple fetch queries on the database and returns a dictionary
of results for each query.</p>
<p>This asynchronous method takes a dictionary where each key is a query
name and each value is a SQLAlchemy <code>Select</code> query object. It also
accepts optional limit and offset parameters. The method executes each
query and returns a dictionary where each key is the query name, and the
corresponding value is a list of records that match that query.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>queries</code></td>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, Select]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dictionary of SQLAlchemy <code>Select</code></p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>query</code></td>
          <td>
                <code>objects. limit (int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The maximum number of records</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>to</code></td>
          <td>
                <code>return for each query. Defaults to 500. offset (int</code>
          </td>
          <td>
            <div class="doc-md-description">
              
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
<td><code>dict</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dictionary where each key is a query name and each value is</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
<td></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>a list of records that match the query.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Raises:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
                <code>Exception</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If any error occurs during the execution of the queries.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">dsg_lib.async_database_functions</span> <span class="kn">import</span> <span class="p">(</span>
<span class="n">async_database</span><span class="p">,</span>
<span class="n">base_schema</span><span class="p">,</span>
<span class="n">database_config</span><span class="p">,</span>
<span class="n">database_operations</span><span class="p">,</span>
<span class="p">)</span>
<span class="c1"># Create a DBConfig instance</span>
<span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># &quot;database_uri&quot;: &quot;postgresql+asyncpg://postgres:postgres@postgresdb/postgres&quot;,</span>
    <span class="s2">&quot;database_uri&quot;</span><span class="p">:</span> <span class="s2">&quot;sqlite+aiosqlite:///:memory:?cache=shared&quot;</span><span class="p">,</span>
    <span class="s2">&quot;echo&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s2">&quot;future&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="c1"># &quot;pool_pre_ping&quot;: True,</span>
    <span class="c1"># &quot;pool_size&quot;: 10,</span>
    <span class="c1"># &quot;max_overflow&quot;: 10,</span>
    <span class="s2">&quot;pool_recycle&quot;</span><span class="p">:</span> <span class="mi">3600</span><span class="p">,</span>
    <span class="c1"># &quot;pool_timeout&quot;: 30,</span>
<span class="p">}</span>
<span class="c1"># create database configuration</span>
<span class="n">db_config</span> <span class="o">=</span> <span class="n">database_config</span><span class="o">.</span><span class="n">DBConfig</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
<span class="c1"># Create an AsyncDatabase instance</span>
<span class="n">async_db</span> <span class="o">=</span> <span class="n">async_database</span><span class="o">.</span><span class="n">AsyncDatabase</span><span class="p">(</span><span class="n">db_config</span><span class="p">)</span>
<span class="c1"># Create a DatabaseOperations instance</span>
<span class="n">db_ops</span> <span class="o">=</span> <span class="n">database_operations</span><span class="o">.</span><span class="n">DatabaseOperations</span><span class="p">(</span><span class="n">async_db</span><span class="p">)</span>
<span class="c1"># read multi query</span>
<span class="n">queries</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;query1&quot;</span><span class="p">:</span> <span class="n">select</span><span class="p">(</span><span class="n">User</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">age</span> <span class="o">&gt;</span> <span class="mi">30</span><span class="p">),</span>
    <span class="s2">&quot;query2&quot;</span><span class="p">:</span> <span class="n">select</span><span class="p">(</span><span class="n">User</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">age</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="p">),</span>
<span class="p">}</span>
<span class="n">results</span> <span class="o">=</span> <span class="k">await</span> <span class="n">db_ops</span><span class="o">.</span><span class="n">read_multi_query</span><span class="p">(</span><span class="n">queries</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div>
</details>
          <details class="quote">
            <summary>Source code in <code>dsg_lib/async_database_functions/database_operations.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">read_multi_query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">queries</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">limit</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Executes multiple fetch queries on the database and returns a dictionary</span>
<span class="sd">    of results for each query.</span>

<span class="sd">    This asynchronous method takes a dictionary where each key is a query</span>
<span class="sd">    name and each value is a SQLAlchemy `Select` query object. It also</span>
<span class="sd">    accepts optional limit and offset parameters. The method executes each</span>
<span class="sd">    query and returns a dictionary where each key is the query name, and the</span>
<span class="sd">    corresponding value is a list of records that match that query.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        queries (Dict[str, Select]): A dictionary of SQLAlchemy `Select`</span>
<span class="sd">        query objects. limit (int, optional): The maximum number of records</span>
<span class="sd">        to return for each query. Defaults to 500. offset (int, optional):</span>
<span class="sd">        The number of records to skip before returning records for each</span>
<span class="sd">        query. Defaults to 0.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary where each key is a query name and each value is</span>
<span class="sd">        a list of records that match the query.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: If any error occurs during the execution of the queries.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        from dsg_lib.async_database_functions import (</span>
<span class="sd">        async_database,</span>
<span class="sd">        base_schema,</span>
<span class="sd">        database_config,</span>
<span class="sd">        database_operations,</span>
<span class="sd">        )</span>
<span class="sd">        # Create a DBConfig instance</span>
<span class="sd">        config = {</span>
<span class="sd">            # &quot;database_uri&quot;: &quot;postgresql+asyncpg://postgres:postgres@postgresdb/postgres&quot;,</span>
<span class="sd">            &quot;database_uri&quot;: &quot;sqlite+aiosqlite:///:memory:?cache=shared&quot;,</span>
<span class="sd">            &quot;echo&quot;: False,</span>
<span class="sd">            &quot;future&quot;: True,</span>
<span class="sd">            # &quot;pool_pre_ping&quot;: True,</span>
<span class="sd">            # &quot;pool_size&quot;: 10,</span>
<span class="sd">            # &quot;max_overflow&quot;: 10,</span>
<span class="sd">            &quot;pool_recycle&quot;: 3600,</span>
<span class="sd">            # &quot;pool_timeout&quot;: 30,</span>
<span class="sd">        }</span>
<span class="sd">        # create database configuration</span>
<span class="sd">        db_config = database_config.DBConfig(config)</span>
<span class="sd">        # Create an AsyncDatabase instance</span>
<span class="sd">        async_db = async_database.AsyncDatabase(db_config)</span>
<span class="sd">        # Create a DatabaseOperations instance</span>
<span class="sd">        db_ops = database_operations.DatabaseOperations(async_db)</span>
<span class="sd">        # read multi query</span>
<span class="sd">        queries = {</span>
<span class="sd">            &quot;query1&quot;: select(User).where(User.age &gt; 30),</span>
<span class="sd">            &quot;query2&quot;: select(User).where(User.age &lt; 20),</span>
<span class="sd">        }</span>
<span class="sd">        results = await db_ops.read_multi_query(queries, limit=10)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Log the start of the operation</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Starting read_multi_query operation&#39;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># Start a new database session</span>
        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">async_db</span><span class="o">.</span><span class="n">get_db_session</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">query_name</span><span class="p">,</span> <span class="n">query</span> <span class="ow">in</span> <span class="n">queries</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="c1"># Log the query being executed</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Executing fetch query: </span><span class="si">{</span><span class="n">query</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

                <span class="c1"># Execute the fetch query and retrieve the records</span>
                <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">session</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">limit</span><span class="p">)</span><span class="o">.</span><span class="n">offset</span><span class="p">(</span><span class="n">offset</span><span class="p">))</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">scalars</span><span class="p">()</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>

                <span class="c1"># Convert the records to dictionaries for logging</span>
                <span class="n">data_dicts</span> <span class="o">=</span> <span class="p">[</span><span class="n">record</span><span class="o">.</span><span class="vm">__dict__</span> <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fetch result for query &#39;</span><span class="si">{</span><span class="n">query_name</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">data_dicts</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

                <span class="c1"># Log the successful query execution</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s1">&#39;Fetch query executed successfully: </span><span class="si">{</span><span class="n">query_name</span><span class="si">}</span><span class="s1"> with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="s1"> records&#39;</span>
                <span class="p">)</span>

                <span class="c1"># Store the records in the results dictionary</span>
                <span class="n">results</span><span class="p">[</span><span class="n">query_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">return</span> <span class="n">results</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
        <span class="c1"># Handle any exceptions that occur during the query execution</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Exception occurred: </span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">handle_exceptions</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="dsg_lib.async_database_functions.database_operations.DatabaseOperations.read_one_record" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>          <code class="highlight language-python"><span class="n">read_one_record</span><span class="p">(</span><span class="n">query</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#dsg_lib.async_database_functions.database_operations.DatabaseOperations.read_one_record" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Retrieves a single record from the database based on the provided query.</p>
<p>This asynchronous method accepts a SQL query object and returns the
first record that matches the query. If no record matches the query, it
returns None. This method is useful for fetching specific data
when the expected result is a single record.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>query</code></td>
          <td>
                <code>Select</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An instance of the SQLAlchemy Select class,</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
<td><code>Result</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The first record that matches the query or None if no record matches.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Raises:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
                <code>Exception</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If any error occurs during the database operation.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">dsg_lib.async_database_functions</span> <span class="kn">import</span> <span class="p">(</span>
<span class="n">async_database</span><span class="p">,</span>
<span class="n">base_schema</span><span class="p">,</span>
<span class="n">database_config</span><span class="p">,</span>
<span class="n">database_operations</span><span class="p">,</span>
<span class="p">)</span>
<span class="c1"># Create a DBConfig instance</span>
<span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># &quot;database_uri&quot;: &quot;postgresql+asyncpg://postgres:postgres@postgresdb/postgres&quot;,</span>
    <span class="s2">&quot;database_uri&quot;</span><span class="p">:</span> <span class="s2">&quot;sqlite+aiosqlite:///:memory:?cache=shared&quot;</span><span class="p">,</span>
    <span class="s2">&quot;echo&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s2">&quot;future&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="c1"># &quot;pool_pre_ping&quot;: True,</span>
    <span class="c1"># &quot;pool_size&quot;: 10,</span>
    <span class="c1"># &quot;max_overflow&quot;: 10,</span>
    <span class="s2">&quot;pool_recycle&quot;</span><span class="p">:</span> <span class="mi">3600</span><span class="p">,</span>
    <span class="c1"># &quot;pool_timeout&quot;: 30,</span>
<span class="p">}</span>
<span class="c1"># create database configuration</span>
<span class="n">db_config</span> <span class="o">=</span> <span class="n">database_config</span><span class="o">.</span><span class="n">DBConfig</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
<span class="c1"># Create an AsyncDatabase instance</span>
<span class="n">async_db</span> <span class="o">=</span> <span class="n">async_database</span><span class="o">.</span><span class="n">AsyncDatabase</span><span class="p">(</span><span class="n">db_config</span><span class="p">)</span>
<span class="c1"># Create a DatabaseOperations instance</span>
<span class="n">db_ops</span> <span class="o">=</span> <span class="n">database_operations</span><span class="o">.</span><span class="n">DatabaseOperations</span><span class="p">(</span><span class="n">async_db</span><span class="p">)</span>
<span class="c1"># read one record</span>
<span class="n">record</span> <span class="o">=</span> <span class="k">await</span> <span class="n">db_ops</span><span class="o">.</span><span class="n">read_one_record</span><span class="p">(</span><span class="n">select</span><span class="p">(</span><span class="n">User</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;John Doe&#39;</span><span class="p">))</span>
</code></pre></div>
</details>
          <details class="quote">
            <summary>Source code in <code>dsg_lib/async_database_functions/database_operations.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">read_one_record</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieves a single record from the database based on the provided query.</span>

<span class="sd">    This asynchronous method accepts a SQL query object and returns the</span>
<span class="sd">    first record that matches the query. If no record matches the query, it</span>
<span class="sd">    returns None. This method is useful for fetching specific data</span>
<span class="sd">    when the expected result is a single record.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        query (Select): An instance of the SQLAlchemy Select class,</span>
<span class="sd">        representing the query to be executed.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Result: The first record that matches the query or None if no record matches.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: If any error occurs during the database operation.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        from dsg_lib.async_database_functions import (</span>
<span class="sd">        async_database,</span>
<span class="sd">        base_schema,</span>
<span class="sd">        database_config,</span>
<span class="sd">        database_operations,</span>
<span class="sd">        )</span>
<span class="sd">        # Create a DBConfig instance</span>
<span class="sd">        config = {</span>
<span class="sd">            # &quot;database_uri&quot;: &quot;postgresql+asyncpg://postgres:postgres@postgresdb/postgres&quot;,</span>
<span class="sd">            &quot;database_uri&quot;: &quot;sqlite+aiosqlite:///:memory:?cache=shared&quot;,</span>
<span class="sd">            &quot;echo&quot;: False,</span>
<span class="sd">            &quot;future&quot;: True,</span>
<span class="sd">            # &quot;pool_pre_ping&quot;: True,</span>
<span class="sd">            # &quot;pool_size&quot;: 10,</span>
<span class="sd">            # &quot;max_overflow&quot;: 10,</span>
<span class="sd">            &quot;pool_recycle&quot;: 3600,</span>
<span class="sd">            # &quot;pool_timeout&quot;: 30,</span>
<span class="sd">        }</span>
<span class="sd">        # create database configuration</span>
<span class="sd">        db_config = database_config.DBConfig(config)</span>
<span class="sd">        # Create an AsyncDatabase instance</span>
<span class="sd">        async_db = async_database.AsyncDatabase(db_config)</span>
<span class="sd">        # Create a DatabaseOperations instance</span>
<span class="sd">        db_ops = database_operations.DatabaseOperations(async_db)</span>
<span class="sd">        # read one record</span>
<span class="sd">        record = await db_ops.read_one_record(select(User).where(User.name == &#39;John Doe&#39;))</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Log the start of the operation</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Starting read_one_record operation for </span><span class="si">{</span><span class="n">query</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Start a new database session</span>
        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">async_db</span><span class="o">.</span><span class="n">get_db_session</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
            <span class="c1"># Log the start of the record retrieval</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Getting record with query: </span><span class="si">{</span><span class="n">query</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="c1"># Execute the query and retrieve the first record</span>
            <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">session</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
            <span class="n">record</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">scalar_one</span><span class="p">()</span>

            <span class="c1"># Log the successful record retrieval</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Record retrieved successfully: </span><span class="si">{</span><span class="n">record</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">record</span>

    <span class="k">except</span> <span class="n">NoResultFound</span><span class="p">:</span>
        <span class="c1"># No record was found</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;No record found&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
        <span class="c1"># Handle any exceptions that occur during the record retrieval</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Exception occurred: </span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>  <span class="c1"># pragma: no cover</span>
        <span class="k">return</span> <span class="n">handle_exceptions</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>  <span class="c1"># pragma: no cover</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="dsg_lib.async_database_functions.database_operations.DatabaseOperations.read_query" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>          <code class="highlight language-python"><span class="n">read_query</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#dsg_lib.async_database_functions.database_operations.DatabaseOperations.read_query" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Executes a fetch query on the database and returns a list of records
that match the query.</p>
<p>This asynchronous method accepts a SQLAlchemy <code>Select</code> query object
along with optional limit and offset parameters. It returns a list of
records that match the query, with the number of records controlled by
the limit, and the starting point of the records determined by the
offset.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>query</code></td>
          <td>
                <code>Select</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A SQLAlchemy <code>Select</code> query object specifying the</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>conditions</code></td>
          <td>
                <code>to fetch records for. limit (int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The maximum</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>optional)</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The number of records to skip before starting to return</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
<td><code>list</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of records that match the query.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Raises:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
                <code>Exception</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If any error occurs during the execution of the query.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">dsg_lib.async_database_functions</span> <span class="kn">import</span> <span class="p">(</span>
<span class="n">async_database</span><span class="p">,</span>
<span class="n">base_schema</span><span class="p">,</span>
<span class="n">database_config</span><span class="p">,</span>
<span class="n">database_operations</span><span class="p">,</span>
<span class="p">)</span>
<span class="c1"># Create a DBConfig instance</span>
<span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># &quot;database_uri&quot;: &quot;postgresql+asyncpg://postgres:postgres@postgresdb/postgres&quot;,</span>
    <span class="s2">&quot;database_uri&quot;</span><span class="p">:</span> <span class="s2">&quot;sqlite+aiosqlite:///:memory:?cache=shared&quot;</span><span class="p">,</span>
    <span class="s2">&quot;echo&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s2">&quot;future&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="c1"># &quot;pool_pre_ping&quot;: True,</span>
    <span class="c1"># &quot;pool_size&quot;: 10,</span>
    <span class="c1"># &quot;max_overflow&quot;: 10,</span>
    <span class="s2">&quot;pool_recycle&quot;</span><span class="p">:</span> <span class="mi">3600</span><span class="p">,</span>
    <span class="c1"># &quot;pool_timeout&quot;: 30,</span>
<span class="p">}</span>
<span class="c1"># create database configuration</span>
<span class="n">db_config</span> <span class="o">=</span> <span class="n">database_config</span><span class="o">.</span><span class="n">DBConfig</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
<span class="c1"># Create an AsyncDatabase instance</span>
<span class="n">async_db</span> <span class="o">=</span> <span class="n">async_database</span><span class="o">.</span><span class="n">AsyncDatabase</span><span class="p">(</span><span class="n">db_config</span><span class="p">)</span>
<span class="c1"># Create a DatabaseOperations instance</span>
<span class="n">db_ops</span> <span class="o">=</span> <span class="n">database_operations</span><span class="o">.</span><span class="n">DatabaseOperations</span><span class="p">(</span><span class="n">async_db</span><span class="p">)</span>
<span class="c1"># read query</span>
<span class="n">records</span> <span class="o">=</span> <span class="k">await</span> <span class="n">db_ops</span><span class="o">.</span><span class="n">read_query</span><span class="p">(</span><span class="n">select</span><span class="p">(</span><span class="n">User</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">age</span> <span class="o">&gt;</span> <span class="mi">30</span><span class="p">),</span> <span class="n">limit</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div>
</details>
          <details class="quote">
            <summary>Source code in <code>dsg_lib/async_database_functions/database_operations.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">read_query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Executes a fetch query on the database and returns a list of records</span>
<span class="sd">    that match the query.</span>

<span class="sd">    This asynchronous method accepts a SQLAlchemy `Select` query object</span>
<span class="sd">    along with optional limit and offset parameters. It returns a list of</span>
<span class="sd">    records that match the query, with the number of records controlled by</span>
<span class="sd">    the limit, and the starting point of the records determined by the</span>
<span class="sd">    offset.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        query (Select): A SQLAlchemy `Select` query object specifying the</span>
<span class="sd">        conditions to fetch records for. limit (int, optional): The maximum</span>
<span class="sd">        number of records to return. Defaults to 500. offset (int,</span>
<span class="sd">        optional): The number of records to skip before starting to return</span>
<span class="sd">        records. Defaults to 0.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: A list of records that match the query.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: If any error occurs during the execution of the query.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        from dsg_lib.async_database_functions import (</span>
<span class="sd">        async_database,</span>
<span class="sd">        base_schema,</span>
<span class="sd">        database_config,</span>
<span class="sd">        database_operations,</span>
<span class="sd">        )</span>
<span class="sd">        # Create a DBConfig instance</span>
<span class="sd">        config = {</span>
<span class="sd">            # &quot;database_uri&quot;: &quot;postgresql+asyncpg://postgres:postgres@postgresdb/postgres&quot;,</span>
<span class="sd">            &quot;database_uri&quot;: &quot;sqlite+aiosqlite:///:memory:?cache=shared&quot;,</span>
<span class="sd">            &quot;echo&quot;: False,</span>
<span class="sd">            &quot;future&quot;: True,</span>
<span class="sd">            # &quot;pool_pre_ping&quot;: True,</span>
<span class="sd">            # &quot;pool_size&quot;: 10,</span>
<span class="sd">            # &quot;max_overflow&quot;: 10,</span>
<span class="sd">            &quot;pool_recycle&quot;: 3600,</span>
<span class="sd">            # &quot;pool_timeout&quot;: 30,</span>
<span class="sd">        }</span>
<span class="sd">        # create database configuration</span>
<span class="sd">        db_config = database_config.DBConfig(config)</span>
<span class="sd">        # Create an AsyncDatabase instance</span>
<span class="sd">        async_db = async_database.AsyncDatabase(db_config)</span>
<span class="sd">        # Create a DatabaseOperations instance</span>
<span class="sd">        db_ops = database_operations.DatabaseOperations(async_db)</span>
<span class="sd">        # read query</span>
<span class="sd">        records = await db_ops.read_query(select(User).where(User.age &gt; 30), limit=10)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Log the start of the operation</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Starting read_query operation&#39;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Start a new database session</span>
        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">async_db</span><span class="o">.</span><span class="n">get_db_session</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
            <span class="c1"># Log the query being executed</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                <span class="sa">f</span><span class="s1">&#39;Executing fetch query: </span><span class="si">{</span><span class="n">query</span><span class="si">}</span><span class="s1"> with limit: </span><span class="si">{</span><span class="n">limit</span><span class="si">}</span><span class="s1"> and offset: </span><span class="si">{</span><span class="n">offset</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="p">)</span>

            <span class="c1"># Execute the fetch query and retrieve the records</span>
            <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">session</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">limit</span><span class="p">)</span><span class="o">.</span><span class="n">offset</span><span class="p">(</span><span class="n">offset</span><span class="p">))</span>
            <span class="n">records</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">scalars</span><span class="p">()</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;read_query result: </span><span class="si">{</span><span class="n">records</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="c1"># Log the successful query execution</span>
            <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">record</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">records</span><span class="p">):</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;read_query result is a tuple </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">records</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="c1"># If all records are tuples, convert them to dictionaries</span>
                <span class="n">records_data</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">((</span><span class="s1">&#39;request_group_id&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">),</span> <span class="n">record</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
                    <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">records</span>
                <span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;read_query result is a dictionary </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">records</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="c1"># Otherwise, try to convert the records to dictionaries using the __dict__ attribute</span>
                <span class="n">records_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">record</span><span class="o">.</span><span class="vm">__dict__</span> <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">records</span><span class="p">]</span>

            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Fetch query executed successfully. Records: </span><span class="si">{</span><span class="n">records_data</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">records</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
        <span class="c1"># Handle any exceptions that occur during the query execution</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Exception occurred: </span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">handle_exceptions</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="dsg_lib.async_database_functions.database_operations.DatabaseOperations.update_one" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>          <code class="highlight language-python"><span class="n">update_one</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">record_id</span><span class="p">,</span> <span class="n">new_values</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#dsg_lib.async_database_functions.database_operations.DatabaseOperations.update_one" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Updates a single record in the database identified by its ID.</p>
<p>This asynchronous method takes a SQLAlchemy <code>Table</code> object, a record ID,
and a dictionary of new values to update the record. It updates the
specified record in the given table with the new values. The method does
not allow updating certain fields, such as 'id' or 'date_created'.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>table</code></td>
          <td>
                <code>Table</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The SQLAlchemy <code>Table</code> object representing the table</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>in</code></td>
          <td>
                <code>the database. record_id (str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The ID of the record to be</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>updated.</code></td>
          <td>
                <code>new_values (dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dictionary containing the fields to</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
<td><code>Base</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The updated record if successful; otherwise, an error</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
<td></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>dictionary.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Raises:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
                <code>Exception</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If any error occurs during the update operation.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">dsg_lib.async_database_functions</span> <span class="kn">import</span> <span class="p">(</span>
<span class="n">async_database</span><span class="p">,</span>
<span class="n">base_schema</span><span class="p">,</span>
<span class="n">database_config</span><span class="p">,</span>
<span class="n">database_operations</span><span class="p">,</span>
<span class="p">)</span>
<span class="c1"># Create a DBConfig instance</span>
<span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># &quot;database_uri&quot;: &quot;postgresql+asyncpg://postgres:postgres@postgresdb/postgres&quot;,</span>
    <span class="s2">&quot;database_uri&quot;</span><span class="p">:</span> <span class="s2">&quot;sqlite+aiosqlite:///:memory:?cache=shared&quot;</span><span class="p">,</span>
    <span class="s2">&quot;echo&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s2">&quot;future&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="c1"># &quot;pool_pre_ping&quot;: True,</span>
    <span class="c1"># &quot;pool_size&quot;: 10,</span>
    <span class="c1"># &quot;max_overflow&quot;: 10,</span>
    <span class="s2">&quot;pool_recycle&quot;</span><span class="p">:</span> <span class="mi">3600</span><span class="p">,</span>
    <span class="c1"># &quot;pool_timeout&quot;: 30,</span>
<span class="p">}</span>
<span class="c1"># create database configuration</span>
<span class="n">db_config</span> <span class="o">=</span> <span class="n">database_config</span><span class="o">.</span><span class="n">DBConfig</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
<span class="c1"># Create an AsyncDatabase instance</span>
<span class="n">async_db</span> <span class="o">=</span> <span class="n">async_database</span><span class="o">.</span><span class="n">AsyncDatabase</span><span class="p">(</span><span class="n">db_config</span><span class="p">)</span>
<span class="c1"># Create a DatabaseOperations instance</span>
<span class="n">db_ops</span> <span class="o">=</span> <span class="n">database_operations</span><span class="o">.</span><span class="n">DatabaseOperations</span><span class="p">(</span><span class="n">async_db</span><span class="p">)</span>
<span class="c1"># update one record</span>
<span class="n">record</span> <span class="o">=</span> <span class="k">await</span> <span class="n">db_ops</span><span class="o">.</span><span class="n">update_one</span><span class="p">(</span><span class="n">User</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;John Smith&#39;</span><span class="p">})</span>
</code></pre></div>
</details>
          <details class="quote">
            <summary>Source code in <code>dsg_lib/async_database_functions/database_operations.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">update_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">record_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">new_values</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Updates a single record in the database identified by its ID.</span>

<span class="sd">    This asynchronous method takes a SQLAlchemy `Table` object, a record ID,</span>
<span class="sd">    and a dictionary of new values to update the record. It updates the</span>
<span class="sd">    specified record in the given table with the new values. The method does</span>
<span class="sd">    not allow updating certain fields, such as &#39;id&#39; or &#39;date_created&#39;.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        table (Table): The SQLAlchemy `Table` object representing the table</span>
<span class="sd">        in the database. record_id (str): The ID of the record to be</span>
<span class="sd">        updated. new_values (dict): A dictionary containing the fields to</span>
<span class="sd">        update and their new values.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Base: The updated record if successful; otherwise, an error</span>
<span class="sd">        dictionary.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: If any error occurs during the update operation.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        from dsg_lib.async_database_functions import (</span>
<span class="sd">        async_database,</span>
<span class="sd">        base_schema,</span>
<span class="sd">        database_config,</span>
<span class="sd">        database_operations,</span>
<span class="sd">        )</span>
<span class="sd">        # Create a DBConfig instance</span>
<span class="sd">        config = {</span>
<span class="sd">            # &quot;database_uri&quot;: &quot;postgresql+asyncpg://postgres:postgres@postgresdb/postgres&quot;,</span>
<span class="sd">            &quot;database_uri&quot;: &quot;sqlite+aiosqlite:///:memory:?cache=shared&quot;,</span>
<span class="sd">            &quot;echo&quot;: False,</span>
<span class="sd">            &quot;future&quot;: True,</span>
<span class="sd">            # &quot;pool_pre_ping&quot;: True,</span>
<span class="sd">            # &quot;pool_size&quot;: 10,</span>
<span class="sd">            # &quot;max_overflow&quot;: 10,</span>
<span class="sd">            &quot;pool_recycle&quot;: 3600,</span>
<span class="sd">            # &quot;pool_timeout&quot;: 30,</span>
<span class="sd">        }</span>
<span class="sd">        # create database configuration</span>
<span class="sd">        db_config = database_config.DBConfig(config)</span>
<span class="sd">        # Create an AsyncDatabase instance</span>
<span class="sd">        async_db = async_database.AsyncDatabase(db_config)</span>
<span class="sd">        # Create a DatabaseOperations instance</span>
<span class="sd">        db_ops = database_operations.DatabaseOperations(async_db)</span>
<span class="sd">        # update one record</span>
<span class="sd">        record = await db_ops.update_one(User, 1, {&#39;name&#39;: &#39;John Smith&#39;})</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">non_updatable_fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;date_created&#39;</span><span class="p">]</span>

    <span class="c1"># Log the start of the operation</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
        <span class="sa">f</span><span class="s1">&#39;Starting update_one operation for record_id: </span><span class="si">{</span><span class="n">record_id</span><span class="si">}</span><span class="s1"> in table: </span><span class="si">{</span><span class="n">table</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Start a new database session</span>
        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">async_db</span><span class="o">.</span><span class="n">get_db_session</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
            <span class="c1"># Log the record being fetched</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Fetching record with id: </span><span class="si">{</span><span class="n">record_id</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="c1"># Fetch the record</span>
            <span class="n">record</span> <span class="o">=</span> <span class="k">await</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">record_id</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">record</span><span class="p">:</span>
                <span class="c1"># Log the error if no record is found</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;No record found with pkid: </span><span class="si">{</span><span class="n">record_id</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="p">{</span>
                    <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="s1">&#39;Record not found&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;details&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;No record found with pkid </span><span class="si">{</span><span class="n">record_id</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
                <span class="p">}</span>

            <span class="c1"># Log the record being updated</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Updating record with new values: </span><span class="si">{</span><span class="n">new_values</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="c1"># Update the record with the new values</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">new_values</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">non_updatable_fields</span><span class="p">:</span>
                    <span class="nb">setattr</span><span class="p">(</span><span class="n">record</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
            <span class="k">await</span> <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

            <span class="c1"># Log the successful record update</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Record updated successfully: </span><span class="si">{</span><span class="n">record</span><span class="o">.</span><span class="n">pkid</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">record</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
        <span class="c1"># Handle any exceptions that occur during the record update</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Exception occurred: </span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">handle_exceptions</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>



<div class="doc doc-object doc-function">



<h3 id="dsg_lib.async_database_functions.database_operations.handle_exceptions" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>          <code class="highlight language-python"><span class="n">handle_exceptions</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span></code>

<a href="#dsg_lib.async_database_functions.database_operations.handle_exceptions" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Handles exceptions for database operations.</p>
<p>This function checks the type of the exception, logs an appropriate error
message, and returns a dictionary containing the error details.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>ex</code></td>
          <td>
                <code>Exception</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The exception to handle.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
<td><code>dict</code></td>          <td>
                <code><span title="typing.Dict">Dict</span>[str, str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dictionary containing the error details. The dictionary has two</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
<td><code>keys</code></td>          <td>
                <code><span title="typing.Dict">Dict</span>[str, str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>'error' and 'details'.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Example:
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">dsg_lib.async_database_functions</span> <span class="kn">import</span> <span class="n">database_operations</span>

<span class="k">try</span><span class="p">:</span>
    <span class="c1"># Some database operation that might raise an exception pass</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
    <span class="n">error_details</span> <span class="o">=</span> <span class="n">database_operations</span><span class="o">.</span><span class="n">handle_exceptions</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">error_details</span><span class="p">)</span>
</code></pre></div></p>

          <details class="quote">
            <summary>Source code in <code>dsg_lib/async_database_functions/database_operations.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">handle_exceptions</span><span class="p">(</span><span class="n">ex</span><span class="p">:</span> <span class="ne">Exception</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles exceptions for database operations.</span>

<span class="sd">    This function checks the type of the exception, logs an appropriate error</span>
<span class="sd">    message, and returns a dictionary containing the error details.</span>

<span class="sd">    Args:</span>
<span class="sd">        ex (Exception): The exception to handle.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary containing the error details. The dictionary has two</span>
<span class="sd">        keys: &#39;error&#39; and &#39;details&#39;.</span>

<span class="sd">    Example:</span>
<span class="sd">    ```python</span>
<span class="sd">    from dsg_lib.async_database_functions import database_operations</span>

<span class="sd">    try:</span>
<span class="sd">        # Some database operation that might raise an exception pass</span>
<span class="sd">    except Exception as ex:</span>
<span class="sd">        error_details = database_operations.handle_exceptions(ex)</span>
<span class="sd">        print(error_details)</span>
<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Extract the error message before the SQL statement</span>
    <span class="n">error_only</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;[SQL:&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Check the type of the exception</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ex</span><span class="p">,</span> <span class="n">IntegrityError</span><span class="p">):</span>
        <span class="c1"># Log the error and return the error details</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;IntegrityError occurred: </span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="s1">&#39;IntegrityError&#39;</span><span class="p">,</span> <span class="s1">&#39;details&#39;</span><span class="p">:</span> <span class="n">error_only</span><span class="p">}</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ex</span><span class="p">,</span> <span class="n">SQLAlchemyError</span><span class="p">):</span>
        <span class="c1"># Log the error and return the error details</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;SQLAlchemyError occurred: </span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="s1">&#39;SQLAlchemyError&#39;</span><span class="p">,</span> <span class="s1">&#39;details&#39;</span><span class="p">:</span> <span class="n">error_only</span><span class="p">}</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Log the error and return the error details</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Exception occurred: </span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="s1">&#39;General Exception&#39;</span><span class="p">,</span> <span class="s1">&#39;details&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">ex</span><span class="p">)}</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2016 - 2024 Mike Ryan
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/devsetgo" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/_devsetgo" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.instant", "navigation.tabs.sticky", "toc.integrate", "toc.follow", "navigation.top"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.3220b9d7.min.js"></script>
      
        <script src="../../js/print-site.js"></script>
      
    
  </body>
</html>